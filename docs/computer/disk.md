# 磁盘

[toc]

## 分区

### parted

[分区工具parted的详解及常用分区使用方法_伏虎游侠的博客-CSDN博客](https://blog.csdn.net/dufufd/article/details/53508367)

## 逻辑卷管理

### 逻辑卷管理详解

[LVM原理及PV、VG、LV、PE、LE关系图_北极星的专栏-CSDN博客_lvm pe](https://blog.csdn.net/lenovouser/article/details/54233570)

  在**零停机**前提下可以自如对文件系统的大小进行调整，可以方便实现文件系统跨越不同磁盘和分区。那么我们可以通过逻辑盘卷管理（LVM，Logical Volume Manager）的方式来非常完美的实现这一功能。

-  LVM是逻辑盘卷管理（Logical Volume Manager） 一种磁盘管理工具
- LVM是建立在硬盘和分区之上的一个逻辑层，来提高磁盘分区管理的灵活性
- 能够实现
  - 若干个磁盘分区连接为一个整块的卷组（volume group）形成一个存储池
  - 在卷组上随意创建逻辑卷组（logical volumes）
  - 并进一步在逻辑卷组上创建文件系统
  - 管理员通过LVM可以方便的调整存储卷组的大小
  - 对磁盘存储按照组的方式进行命名、管理和分配 随便取名字 比如 DBData 而不是使用 sda sdb 

![image](https://static.lovedata.net/21-01-06-7f984fae6c53848f218010bc6aa4172c.png-wm)

#### LVM基本术语

1. 物理存储介质（The physical media）指硬盘

2. 物理卷(physical volume) 

   1. 物理卷就是指硬盘分区或从逻辑上与磁盘分区具有同样功能的设备(如RAID)，是LVM的基本存储逻辑块

3. 卷组（Volume Group）

   1. LVM卷组类似于非LVM系统中的物理硬盘，其由物理卷组成。
   2. 可以在卷组上建立多个LVM分区（逻辑卷）
   3. LVM卷组有一个或多个物理卷组成

4. 逻辑卷（Logicalvolume）

   1. LVM的逻辑卷类似于非LVM系统中的硬盘分区

5. PE（physical extent）

   1. 物理卷被划分为称为PE(Physical Extents)的基本单元
   2. 有编号，PE是可以被LVM寻址的最小单元，可配置 默认 4MB

6. LE（logical extent）

   1. 逻辑卷也被分成为LE的可被寻址的基本单位
   2. 同一个卷组与PE大小相同，一一对应

   ![image](https://static.lovedata.net/21-01-06-c50f972ab1c65e6a1ce9a108208721af.png-wm)

   ![image](https://static.lovedata.net/21-01-06-fe7583ce01b4e7d8b6fa3dd62e605307.png-wm)

磁盘分区、卷组、逻辑卷和文件系统之间的逻辑关系的示意图

![image](https://static.lovedata.net/21-01-06-2d3436190f33b215a4d3379367adb0a3.png-wm)

## RAID(独立冗余磁盘阵列)

> 摘自《Linux就该这么学》

### 由来

CPU性能高速增长，为磁盘性能提升优先，逐渐成为瓶颈，并且磁盘持续、频繁IO操作，损坏几率更大，数据丢失的几率也增加。

RAID技术通过把多个**硬盘设备**组合成一个**容量更大**、**安全性更好**的磁盘阵列，并把数据切割成多个区段后分别存放在各个不同的物理硬盘设备上，然后利用**分散读写**技术来**提升磁盘阵列整体的性能**，同时把多个**重要数据的副本**同步到不同的物理硬盘设备上，从而起到了非常好的数据**冗余备份**效果。

缺点：数据多份，有成本。 但是数据本身价值更大，现代企业更看重冗余备份和带来的磁盘吞吐量的提升。 



### RAID 0 

把多块物理硬盘设备（至少两块）串联在一起，组成一个大的卷组。 

数据依次写入每个物理磁盘。

读写性能提升数倍，但是任意一个硬盘损坏，整个系统数据都被破坏。

提升吞吐速度，不具备数据容错能力

![image](https://static.lovedata.net/21-01-07-f568482573164a6f405df4a7b4592e38.png-wm)



### RAID1

RAID0 数据是分开存放的。

如果生产环境对硬盘设备的读写速度没有要求，而是希望增加数据的安全性时，就需要用到RAID1技术

如果，由两块以上的硬盘进行绑定，同时写入多块设备上，一块硬盘故障，会立即自动移热交换方式恢复数据

![image](https://static.lovedata.net/21-01-07-c722b4c4f17e63f221c1dfd2f7dbd46e.png-wm)



缺点：

1. 磁盘利用率低下，上图只有50%
2. 数据同时写入两块以上磁盘，增加系统负载

### RAID5 

RAID5技术虽然在理论上兼顾了三者（读写速度、数据安全性、成本），但实际上更像是对这三者的“相互妥协”

把硬盘设备的奇偶校验信息保存在其他硬盘设备中，好处是其中任何一块设备损坏后不至于出现致命缺陷。 

并没有别分硬盘的真实数据，而是在硬盘损坏后通过奇偶校验信息尝试重建损坏的数据。

是一种妥协，坚固了读写速度、数据安全性和存储成本

![image](https://static.lovedata.net/21-01-07-3df65504fc8f8dfaf9b9de9daba29342.png-wm)



### RAID10

RAID5 是妥协

大部分企业更在乎的是数据本身的价值而非硬盘价格，因此生产环境中主要使用RAID10技术。

RAID10技术是RAID1+RAID0技术的一个“组合体”。 

至少4块硬盘来组建，分别 两辆制作 RAID1磁盘阵列，保证**数据安全性**

然后对两个RIAID1磁盘阵列试试RAID0技术，提升读写速度

只要不坏一个组所有硬盘，最多可以损坏百分之五十的硬盘不丢失数据

吸取了RAID0 高速读写 和 RAID1 数据安全的，不考虑成本下，性能超过RAID5

![image](https://static.lovedata.net/21-01-07-f4677dbc1254051fd919379f6cc69400.png-wm)

