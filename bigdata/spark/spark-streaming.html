<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spark Streaming | ç¼–ç¨‹æ‰‹å†Œ</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="è‹ç©¹æµ©æ¸º,å–ä¹‹é¡»è‡¾">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.225a8ff9.css" as="style"><link rel="preload" href="/assets/js/app.0f56a723.js" as="script"><link rel="preload" href="/assets/js/4.a8ef5668.js" as="script"><link rel="preload" href="/assets/js/119.09fec567.js" as="script"><link rel="preload" href="/assets/js/11.0473ae06.js" as="script"><link rel="prefetch" href="/assets/js/10.06cc4fbb.js"><link rel="prefetch" href="/assets/js/100.79e96d05.js"><link rel="prefetch" href="/assets/js/101.bcac0b9f.js"><link rel="prefetch" href="/assets/js/102.c5d92a95.js"><link rel="prefetch" href="/assets/js/103.697856ab.js"><link rel="prefetch" href="/assets/js/104.8f2db4d2.js"><link rel="prefetch" href="/assets/js/105.d4f2bb07.js"><link rel="prefetch" href="/assets/js/106.1a533c3f.js"><link rel="prefetch" href="/assets/js/107.b2845ea0.js"><link rel="prefetch" href="/assets/js/108.226e46ed.js"><link rel="prefetch" href="/assets/js/109.0de9c16c.js"><link rel="prefetch" href="/assets/js/110.4657c34b.js"><link rel="prefetch" href="/assets/js/111.3409d3a7.js"><link rel="prefetch" href="/assets/js/112.a46b486c.js"><link rel="prefetch" href="/assets/js/113.ba001fa9.js"><link rel="prefetch" href="/assets/js/114.ad1e6ba1.js"><link rel="prefetch" href="/assets/js/115.a0ac732f.js"><link rel="prefetch" href="/assets/js/116.4ee2a7b2.js"><link rel="prefetch" href="/assets/js/117.a76fd29a.js"><link rel="prefetch" href="/assets/js/118.83c5badf.js"><link rel="prefetch" href="/assets/js/12.286e979d.js"><link rel="prefetch" href="/assets/js/120.42120fe1.js"><link rel="prefetch" href="/assets/js/121.9d79a9dd.js"><link rel="prefetch" href="/assets/js/122.f71a459c.js"><link rel="prefetch" href="/assets/js/123.b75308dc.js"><link rel="prefetch" href="/assets/js/124.e4d4643b.js"><link rel="prefetch" href="/assets/js/125.73fc990d.js"><link rel="prefetch" href="/assets/js/126.3b0eccd0.js"><link rel="prefetch" href="/assets/js/127.3eb3ab27.js"><link rel="prefetch" href="/assets/js/128.64ba68bb.js"><link rel="prefetch" href="/assets/js/129.82cfac7a.js"><link rel="prefetch" href="/assets/js/13.7207d991.js"><link rel="prefetch" href="/assets/js/130.42811f32.js"><link rel="prefetch" href="/assets/js/131.6f498e16.js"><link rel="prefetch" href="/assets/js/132.f0cc9ad2.js"><link rel="prefetch" href="/assets/js/133.325e755a.js"><link rel="prefetch" href="/assets/js/134.076a808c.js"><link rel="prefetch" href="/assets/js/135.fad7be83.js"><link rel="prefetch" href="/assets/js/136.042fc555.js"><link rel="prefetch" href="/assets/js/137.b67b55bc.js"><link rel="prefetch" href="/assets/js/138.6476c99f.js"><link rel="prefetch" href="/assets/js/139.ad07500f.js"><link rel="prefetch" href="/assets/js/14.a1cb7c1b.js"><link rel="prefetch" href="/assets/js/140.3edd2237.js"><link rel="prefetch" href="/assets/js/141.5181db27.js"><link rel="prefetch" href="/assets/js/142.67b4c4a2.js"><link rel="prefetch" href="/assets/js/143.9d249a3f.js"><link rel="prefetch" href="/assets/js/144.e6db5540.js"><link rel="prefetch" href="/assets/js/145.5b4305a7.js"><link rel="prefetch" href="/assets/js/146.bc674178.js"><link rel="prefetch" href="/assets/js/147.964ff3df.js"><link rel="prefetch" href="/assets/js/148.570b6864.js"><link rel="prefetch" href="/assets/js/149.4b9796c2.js"><link rel="prefetch" href="/assets/js/15.3cafda64.js"><link rel="prefetch" href="/assets/js/150.c677bf4b.js"><link rel="prefetch" href="/assets/js/151.b8977c93.js"><link rel="prefetch" href="/assets/js/152.535e2db4.js"><link rel="prefetch" href="/assets/js/153.754fc05e.js"><link rel="prefetch" href="/assets/js/154.5a5928b6.js"><link rel="prefetch" href="/assets/js/155.19893ca5.js"><link rel="prefetch" href="/assets/js/156.da1f2665.js"><link rel="prefetch" href="/assets/js/157.cb7b551f.js"><link rel="prefetch" href="/assets/js/158.f5d94a11.js"><link rel="prefetch" href="/assets/js/159.0b2b78d9.js"><link rel="prefetch" href="/assets/js/16.54ab9242.js"><link rel="prefetch" href="/assets/js/160.c2548b6c.js"><link rel="prefetch" href="/assets/js/161.8f694ed1.js"><link rel="prefetch" href="/assets/js/162.1adc1aa4.js"><link rel="prefetch" href="/assets/js/163.5688827c.js"><link rel="prefetch" href="/assets/js/164.8442474f.js"><link rel="prefetch" href="/assets/js/165.d0e21e5c.js"><link rel="prefetch" href="/assets/js/166.2e90ae99.js"><link rel="prefetch" href="/assets/js/167.374185de.js"><link rel="prefetch" href="/assets/js/168.2426769f.js"><link rel="prefetch" href="/assets/js/169.829516d9.js"><link rel="prefetch" href="/assets/js/17.9cad59f9.js"><link rel="prefetch" href="/assets/js/170.db0c4609.js"><link rel="prefetch" href="/assets/js/171.7bdcc41b.js"><link rel="prefetch" href="/assets/js/172.7f7ab109.js"><link rel="prefetch" href="/assets/js/173.c1d51df9.js"><link rel="prefetch" href="/assets/js/174.afa4c5f6.js"><link rel="prefetch" href="/assets/js/175.b46d9dd8.js"><link rel="prefetch" href="/assets/js/176.c38ba756.js"><link rel="prefetch" href="/assets/js/177.ba85b912.js"><link rel="prefetch" href="/assets/js/178.af1a44e8.js"><link rel="prefetch" href="/assets/js/179.e097e164.js"><link rel="prefetch" href="/assets/js/18.3776b09c.js"><link rel="prefetch" href="/assets/js/180.d9d5d80c.js"><link rel="prefetch" href="/assets/js/181.79401f8c.js"><link rel="prefetch" href="/assets/js/182.343db47f.js"><link rel="prefetch" href="/assets/js/183.005841bb.js"><link rel="prefetch" href="/assets/js/19.d0ac1e7f.js"><link rel="prefetch" href="/assets/js/20.e0100fb2.js"><link rel="prefetch" href="/assets/js/21.f59cd52c.js"><link rel="prefetch" href="/assets/js/22.3ecf54da.js"><link rel="prefetch" href="/assets/js/23.2508850b.js"><link rel="prefetch" href="/assets/js/24.0ac10322.js"><link rel="prefetch" href="/assets/js/25.7c3ee156.js"><link rel="prefetch" href="/assets/js/26.7021c42c.js"><link rel="prefetch" href="/assets/js/27.d716476b.js"><link rel="prefetch" href="/assets/js/28.58ebf808.js"><link rel="prefetch" href="/assets/js/29.88c37f6c.js"><link rel="prefetch" href="/assets/js/30.87bc4a91.js"><link rel="prefetch" href="/assets/js/31.a69c2a35.js"><link rel="prefetch" href="/assets/js/32.89f74912.js"><link rel="prefetch" href="/assets/js/33.df886872.js"><link rel="prefetch" href="/assets/js/34.835d0785.js"><link rel="prefetch" href="/assets/js/35.5e38ab06.js"><link rel="prefetch" href="/assets/js/36.5b639051.js"><link rel="prefetch" href="/assets/js/37.bb32ead0.js"><link rel="prefetch" href="/assets/js/38.c2541da0.js"><link rel="prefetch" href="/assets/js/39.3c8f0f06.js"><link rel="prefetch" href="/assets/js/40.4cc077aa.js"><link rel="prefetch" href="/assets/js/41.cbcd81a7.js"><link rel="prefetch" href="/assets/js/42.6d002f78.js"><link rel="prefetch" href="/assets/js/43.3f67c882.js"><link rel="prefetch" href="/assets/js/44.58ce7a4d.js"><link rel="prefetch" href="/assets/js/45.bfb9d6e0.js"><link rel="prefetch" href="/assets/js/46.691097de.js"><link rel="prefetch" href="/assets/js/47.e6b5c9b5.js"><link rel="prefetch" href="/assets/js/48.38159f5c.js"><link rel="prefetch" href="/assets/js/49.e03ce66a.js"><link rel="prefetch" href="/assets/js/5.340b4b76.js"><link rel="prefetch" href="/assets/js/50.7df345cb.js"><link rel="prefetch" href="/assets/js/51.b3eed5d5.js"><link rel="prefetch" href="/assets/js/52.bb282842.js"><link rel="prefetch" href="/assets/js/53.6b21ec8f.js"><link rel="prefetch" href="/assets/js/54.bab98944.js"><link rel="prefetch" href="/assets/js/55.59437904.js"><link rel="prefetch" href="/assets/js/56.18b88131.js"><link rel="prefetch" href="/assets/js/57.b0cbba56.js"><link rel="prefetch" href="/assets/js/58.d9379002.js"><link rel="prefetch" href="/assets/js/59.e8663882.js"><link rel="prefetch" href="/assets/js/6.c48e1ddb.js"><link rel="prefetch" href="/assets/js/60.0a00b724.js"><link rel="prefetch" href="/assets/js/61.cd09980d.js"><link rel="prefetch" href="/assets/js/62.b092ff62.js"><link rel="prefetch" href="/assets/js/63.86482c79.js"><link rel="prefetch" href="/assets/js/64.3c1ee4d2.js"><link rel="prefetch" href="/assets/js/65.0621decf.js"><link rel="prefetch" href="/assets/js/66.cf7a6241.js"><link rel="prefetch" href="/assets/js/67.99e103bc.js"><link rel="prefetch" href="/assets/js/68.b3589f28.js"><link rel="prefetch" href="/assets/js/69.f0932a12.js"><link rel="prefetch" href="/assets/js/7.0f410b85.js"><link rel="prefetch" href="/assets/js/70.0a941773.js"><link rel="prefetch" href="/assets/js/71.3a6c6141.js"><link rel="prefetch" href="/assets/js/72.2299ff58.js"><link rel="prefetch" href="/assets/js/73.544fe8c6.js"><link rel="prefetch" href="/assets/js/74.98219c05.js"><link rel="prefetch" href="/assets/js/75.244a9d80.js"><link rel="prefetch" href="/assets/js/76.cefd9fe2.js"><link rel="prefetch" href="/assets/js/77.59793840.js"><link rel="prefetch" href="/assets/js/78.a7d9a079.js"><link rel="prefetch" href="/assets/js/79.f9ec013d.js"><link rel="prefetch" href="/assets/js/8.269955a4.js"><link rel="prefetch" href="/assets/js/80.b0f2cbe5.js"><link rel="prefetch" href="/assets/js/81.3d245e9a.js"><link rel="prefetch" href="/assets/js/82.061b170d.js"><link rel="prefetch" href="/assets/js/83.d2c42148.js"><link rel="prefetch" href="/assets/js/84.f6f487a4.js"><link rel="prefetch" href="/assets/js/85.c5305650.js"><link rel="prefetch" href="/assets/js/86.0c30a2ef.js"><link rel="prefetch" href="/assets/js/87.d9a99f2e.js"><link rel="prefetch" href="/assets/js/88.03792030.js"><link rel="prefetch" href="/assets/js/89.95684850.js"><link rel="prefetch" href="/assets/js/9.5c3462fb.js"><link rel="prefetch" href="/assets/js/90.185b012e.js"><link rel="prefetch" href="/assets/js/91.d19f0020.js"><link rel="prefetch" href="/assets/js/92.9e7855de.js"><link rel="prefetch" href="/assets/js/93.1ee902df.js"><link rel="prefetch" href="/assets/js/94.4bfab4ad.js"><link rel="prefetch" href="/assets/js/95.5f0b1d15.js"><link rel="prefetch" href="/assets/js/96.bd50a446.js"><link rel="prefetch" href="/assets/js/97.749fd671.js"><link rel="prefetch" href="/assets/js/98.bc09c746.js"><link rel="prefetch" href="/assets/js/99.40f98e75.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.98d8c7d3.js"><link rel="prefetch" href="/assets/js/vendors~notification.5515ddcd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.225a8ff9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ç¼–ç¨‹æ‰‹å†Œ</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  å¤§æ•°æ®
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç®—æ³• 
</a></div><div class="nav-item"><a href="/architecture/" class="nav-link">
  æ¶æ„ 
</a></div><div class="nav-item"><a href="/computer/" class="nav-link">
  è®¡ç®—æœº 
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  æ•°æ®åº“ 
</a></div><div class="nav-item"><a href="/fe/" class="nav-link">
  å‰ç«¯
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è¿ç»´ " class="dropdown-title"><span class="title">è¿ç»´ </span> <span class="arrow down"></span></button> <button type="button" aria-label="è¿ç»´ " class="mobile-dropdown-title"><span class="title">è¿ç»´ </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ops/" class="nav-link">
  åŸºç¡€
</a></li><li class="dropdown-item"><h4>
          åˆ†ç±»
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ops/java.html" class="nav-link">
  Java
</a></li><li class="dropdown-subitem"><a href="/ops/bigdata.html" class="nav-link">
  å¤§æ•°æ®
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç¨‹" class="dropdown-title"><span class="title">ç¼–ç¨‹</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç¨‹" class="mobile-dropdown-title"><span class="title">ç¼–ç¨‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¯­è¨€
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/programming/python.html" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/programming/scala.html" class="nav-link">
  Scala
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="èµ„æº" class="dropdown-title"><span class="title">èµ„æº</span> <span class="arrow down"></span></button> <button type="button" aria-label="èµ„æº" class="mobile-dropdown-title"><span class="title">èµ„æº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          æˆ‘çš„ä¹¦å•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/tech.html" class="nav-link">
  æŠ€æœ¯ç±»
</a></li><li class="dropdown-subitem"><a href="/book/growth.html" class="nav-link">
  æˆé•¿ç±»
</a></li></ul></li><li class="dropdown-item"><h4>
          ç½‘è¯¾
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/geek.html" class="nav-link">
  ä¸“æ 
</a></li><li class="dropdown-subitem"><a href="/book/video.html" class="nav-link">
  è§†é¢‘
</a></li></ul></li><li class="dropdown-item"><h4>
          é¢ç»
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/tech.html" class="nav-link">
  å¤§å‚é¢ç»
</a></li><li class="dropdown-subitem"><a href="/interview/sword-to-offer.html" class="nav-link">
  å‰‘æŒ‡Offer
</a></li><li class="dropdown-subitem"><a href="/interview/fe.html" class="nav-link">
  å‰ç«¯é¢ç»
</a></li><li class="dropdown-subitem"><a href="/interview/interview_guide.html" class="nav-link">
  é¢è¯•å¯¼èˆª
</a></li></ul></li><li class="dropdown-item"><h4>
          å…¶ä»–
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/study.html" class="nav-link">
  å­¦ä¹ ç¬”è®°
</a></li></ul></li></ul></div></div> <a href="https://github.com/pengshuangbao/databook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  å¤§æ•°æ®
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç®—æ³• 
</a></div><div class="nav-item"><a href="/architecture/" class="nav-link">
  æ¶æ„ 
</a></div><div class="nav-item"><a href="/computer/" class="nav-link">
  è®¡ç®—æœº 
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  æ•°æ®åº“ 
</a></div><div class="nav-item"><a href="/fe/" class="nav-link">
  å‰ç«¯
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è¿ç»´ " class="dropdown-title"><span class="title">è¿ç»´ </span> <span class="arrow down"></span></button> <button type="button" aria-label="è¿ç»´ " class="mobile-dropdown-title"><span class="title">è¿ç»´ </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ops/" class="nav-link">
  åŸºç¡€
</a></li><li class="dropdown-item"><h4>
          åˆ†ç±»
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ops/java.html" class="nav-link">
  Java
</a></li><li class="dropdown-subitem"><a href="/ops/bigdata.html" class="nav-link">
  å¤§æ•°æ®
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç¨‹" class="dropdown-title"><span class="title">ç¼–ç¨‹</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç¨‹" class="mobile-dropdown-title"><span class="title">ç¼–ç¨‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¯­è¨€
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/programming/python.html" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/programming/scala.html" class="nav-link">
  Scala
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="èµ„æº" class="dropdown-title"><span class="title">èµ„æº</span> <span class="arrow down"></span></button> <button type="button" aria-label="èµ„æº" class="mobile-dropdown-title"><span class="title">èµ„æº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          æˆ‘çš„ä¹¦å•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/tech.html" class="nav-link">
  æŠ€æœ¯ç±»
</a></li><li class="dropdown-subitem"><a href="/book/growth.html" class="nav-link">
  æˆé•¿ç±»
</a></li></ul></li><li class="dropdown-item"><h4>
          ç½‘è¯¾
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/geek.html" class="nav-link">
  ä¸“æ 
</a></li><li class="dropdown-subitem"><a href="/book/video.html" class="nav-link">
  è§†é¢‘
</a></li></ul></li><li class="dropdown-item"><h4>
          é¢ç»
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/tech.html" class="nav-link">
  å¤§å‚é¢ç»
</a></li><li class="dropdown-subitem"><a href="/interview/sword-to-offer.html" class="nav-link">
  å‰‘æŒ‡Offer
</a></li><li class="dropdown-subitem"><a href="/interview/fe.html" class="nav-link">
  å‰ç«¯é¢ç»
</a></li><li class="dropdown-subitem"><a href="/interview/interview_guide.html" class="nav-link">
  é¢è¯•å¯¼èˆª
</a></li></ul></li><li class="dropdown-item"><h4>
          å…¶ä»–
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/study.html" class="nav-link">
  å­¦ä¹ ç¬”è®°
</a></li></ul></li></ul></div></div> <a href="https://github.com/pengshuangbao/databook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/bigdata/" aria-current="page" class="sidebar-link">å¤§æ•°æ®</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hadoop</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Spark</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/spark/spark-streaming.html" aria-current="page" class="active sidebar-link">Spark Streaming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata/spark/spark-streaming.html#spark-streaming-åŸºç¡€" class="sidebar-link">Spark Streaming åŸºç¡€</a></li></ul></li><li><a href="/bigdata/spark/spark.html" class="sidebar-link">Spark</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flink</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kylin</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kafka</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hbase</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ClickHouse</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Impala</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kudu</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>hive</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/bigdata/zookeeper.html" class="sidebar-link">Zookeeper</a></li><li><a href="/bigdata/solution.html" class="sidebar-link">è§£å†³æ–¹æ¡ˆ</a></li><li><a href="/bigdata/design.html" class="sidebar-link">ç¼–ç¨‹è®¾è®¡</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="spark-streaming"><a href="#spark-streaming" class="header-anchor">#</a> Spark Streaming</h1> <p></p><div class="table-of-contents"><ul><li><a href="#spark-streaming-åŸºç¡€">Spark Streaming åŸºç¡€</a><ul><li><a href="#spark-streamingå’Œstormæœ‰ä½•åŒºåˆ«-åº”ç”¨åœºæ™¯">Spark Streamingå’ŒStormæœ‰ä½•åŒºåˆ«? åº”ç”¨åœºæ™¯?</a></li><li><a href="#spark-streaming-åŸç†">Spark Streaming åŸç†</a></li><li><a href="#ss-æ•´ä½“æ¨¡å—">SS æ•´ä½“æ¨¡å—</a></li><li><a href="#dstream-dstreamgraph-æ¶æ„åŸç†">DStream, DStreamGraph æ¶æ„åŸç†</a></li><li><a href="#dstream-ç”Ÿæˆ-rdd-çš„åŸç†">DStream ç”Ÿæˆ RDD çš„åŸç†</a></li><li><a href="#jobscheduler-job-jobset-åŸç†">JobScheduler, Job, JobSet åŸç†</a></li><li><a href="#jobgenerator-åŸç†">JobGenerator åŸç†</a></li><li><a href="#receiver-åˆ†å‘è¯¦è§£">Receiver åˆ†å‘è¯¦è§£</a></li><li><a href="#receiver-receiversupervisor-blockgenerator-receivedblockhandler-è¯¦è§£">Receiver, ReceiverSupervisor, BlockGenerator, ReceivedBlockHandler è¯¦è§£</a></li><li><a href="#receivertraker-receivedblocktracker-è¯¦è§£">ReceiverTraker, ReceivedBlockTracker è¯¦è§£</a></li><li><a href="#å¸¸ç”¨åè¯ä»‹ç»">å¸¸ç”¨åè¯ä»‹ç»</a></li><li><a href="#ssä¸stormçš„å¯¹æ¯”">SSä¸Stormçš„å¯¹æ¯”</a></li></ul></li></ul></div><p></p> <h2 id="spark-streaming-åŸºç¡€"><a href="#spark-streaming-åŸºç¡€" class="header-anchor">#</a> Spark Streaming åŸºç¡€</h2> <h3 id="spark-streamingå’Œstormæœ‰ä½•åŒºåˆ«-åº”ç”¨åœºæ™¯"><a href="#spark-streamingå’Œstormæœ‰ä½•åŒºåˆ«-åº”ç”¨åœºæ™¯" class="header-anchor">#</a> Spark Streamingå’ŒStormæœ‰ä½•åŒºåˆ«? åº”ç”¨åœºæ™¯?</h3> <h3 id="spark-streaming-åŸç†"><a href="#spark-streaming-åŸç†" class="header-anchor">#</a> Spark Streaming åŸç†</h3> <p><img src="https://static.lovedata.net/jpg/2018/6/14/4c10e84fe55db71e105e0a2a7c3ad10a.jpg" alt="image"> <img src="https://static.lovedata.net/jpg/2018/6/14/4cd553817fa7f91d206508dad84ded7a.jpg" alt="image"> <img src="https://static.lovedata.net/jpg/2018/6/14/854a01530c476d05f6987ac329873022.jpg" alt="image"> <img src="https://static.lovedata.net/jpg/2018/6/14/8c6963c0dfb3f36398c7b43a823889d6.jpg" alt="image"></p> <p>å‚è€ƒ</p> <ol><li><a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/0.1%20Spark%20Streaming%20%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%A8%A1%E5%9D%97%E6%A6%82%E8%BF%B0.md#24" target="_blank" rel="noopener noreferrer">CoolplaySpark/0.1 Spark Streaming å®ç°æ€è·¯ä¸æ¨¡å—æ¦‚è¿°.md at master Â· lw-lin/CoolplaySpark Â· GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <h3 id="ss-æ•´ä½“æ¨¡å—"><a href="#ss-æ•´ä½“æ¨¡å—" class="header-anchor">#</a> SS æ•´ä½“æ¨¡å—</h3> <ul><li>æ¨¡å— 1ï¼šDAG é™æ€å®šä¹‰
<ul><li>åº”è¯¥é¦–å…ˆå¯¹è®¡ç®—é€»è¾‘æè¿°ä¸ºä¸€ä¸ª RDD DAG çš„â€œæ¨¡æ¿â€ï¼Œåœ¨åé¢ Job åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸ª batchï¼ŒSpark Streaming éƒ½å°†æ ¹æ®è¿™ä¸ªâ€œæ¨¡æ¿â€ç”Ÿæˆä¸€ä¸ª RDD DAG çš„å®ä¾‹ã€‚</li> <li>DStream å’Œ RDD çš„å…³ç³»
<ul><li>DStream æ˜¯ RDD çš„æ¨¡æ¿ï¼Œè€Œä¸” DStream å’Œ RDD å…·æœ‰ç›¸åŒçš„ transformation æ“ä½œï¼Œæ¯”å¦‚ map(), filter(), reduce() â€¦â€¦ç­‰ç­‰ï¼ˆæ­£æ˜¯è¿™äº›ç›¸åŒçš„ transformation ä½¿å¾— DStreamGraph èƒ½å¤Ÿå¿ å®è®°å½• RDD DAG çš„è®¡ç®—é€»è¾‘ï¼‰</li> <li>DStream ç»´æŠ¤äº†å¯¹æ¯ä¸ªäº§å‡ºçš„ RDD å®ä¾‹çš„å¼•ç”¨</li> <li>å¯ä»¥è®¤ä¸ºï¼ŒRDD åŠ ä¸Š batch ç»´åº¦å°±æ˜¯ DStreamï¼ŒDStream å»æ‰ batch ç»´åº¦å°±æ˜¯ RDD â€”â€” å°±åƒ RDD = DStream at batch Tã€‚</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/a704df7e8a3741d155cf29be66954f81.jpg" alt="image"></li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/4084d7de41feac45d85e112841f3b5a5.jpg" alt="Apache Storm  å’Œ storm ä¸åŒçš„åœ°æ–¹"></li></ul></li></ul></li> <li>æ¨¡å— 2ï¼šJob åŠ¨æ€ç”Ÿæˆ
<ul><li>åœ¨ Spark Streaming é‡Œï¼Œæ€»ä½“è´Ÿè´£åŠ¨æ€ä½œä¸šè°ƒåº¦çš„å…·ä½“ç±»æ˜¯ <strong>JobScheduler</strong> ï¼Œåœ¨ <strong>Spark Streaming ç¨‹åºå¼€å§‹è¿è¡Œçš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ª JobScheduler</strong> çš„å®ä¾‹ï¼Œå¹¶è¢«  <strong>start()</strong> è¿è¡Œèµ·æ¥</li> <li>JobScheduler æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„æˆå‘˜ï¼šJobGenerator å’Œ ReceiverTrackerã€‚
<ul><li>JobScheduler å°†æ¯ä¸ª batch çš„ RDD DAG å…·ä½“ç”Ÿæˆå·¥ä½œå§”æ‰˜ç»™ <strong>JobGenerator</strong></li> <li>è€Œå°†æºå¤´è¾“å…¥æ•°æ®çš„è®°å½•å·¥ä½œå§”æ‰˜ç»™ <strong>ReceiverTrackerã€‚</strong></li></ul></li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/c9db933b1dfacee3182ebfe4321ab02a.jpg" alt="image"></li> <li>JobGenerator ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå‘¨æœŸå°±æ˜¯æˆ‘ä»¬åˆšåˆšæåˆ°çš„ batchDurationï¼Œå®šæ—¶ä¸ºæ¯ä¸ª batch ç”Ÿæˆ RDD DAG çš„å®ä¾‹ã€‚
<ul><li>è¦æ±‚ ReceiverTracker å°†ç›®å‰å·²æ”¶åˆ°çš„æ•°æ®è¿›è¡Œä¸€æ¬¡ allocateï¼Œå³å°†ä¸Šæ¬¡ batch åˆ‡åˆ†åçš„æ•°æ®åˆ‡åˆ†åˆ°åˆ°æœ¬æ¬¡æ–°çš„ batch é‡Œï¼›</li> <li>è¦æ±‚ DStreamGraph å¤åˆ¶å‡ºä¸€å¥—æ–°çš„ RDD DAG çš„å®ä¾‹ï¼Œå…·ä½“è¿‡ç¨‹æ˜¯ï¼šDStreamGraph å°†è¦æ±‚å›¾é‡Œçš„å°¾ DStream èŠ‚ç‚¹ç”Ÿæˆå…·ä½“çš„ RDD å®ä¾‹ï¼Œå¹¶é€’å½’çš„è°ƒç”¨å°¾ DStream çš„ä¸Šæ¸¸ DStream èŠ‚ç‚¹â€¦â€¦ä»¥æ­¤éå†æ•´ä¸ª DStreamGraphï¼Œéå†ç»“æŸä¹Ÿå°±æ­£å¥½ç”Ÿæˆäº† RDD DAG çš„å®ä¾‹ï¼›</li> <li>è·å–ç¬¬ 1 æ­¥ ReceiverTracker åˆ†é…åˆ°æœ¬ batch çš„æºå¤´æ•°æ®çš„ meta ä¿¡æ¯ï¼›</li> <li>å°†ç¬¬ 2 æ­¥ç”Ÿæˆçš„æœ¬ batch çš„ RDD DAGï¼Œå’Œç¬¬ 3 æ­¥è·å–åˆ°çš„ meta ä¿¡æ¯ï¼Œä¸€åŒæäº¤ç»™ JobScheduler å¼‚æ­¥æ‰§è¡Œï¼›</li> <li>åªè¦æäº¤ç»“æŸï¼ˆä¸ç®¡æ˜¯å¦å·²å¼€å§‹å¼‚æ­¥æ‰§è¡Œï¼‰ï¼Œå°±é©¬ä¸Šå¯¹æ•´ä¸ªç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€åšä¸€ä¸ª checkpointã€‚</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/db592ed6c11c4075d92d4ceb99866b5b.jpg" alt="image"></li></ul></li></ul></li> <li>æ¨¡å— 3ï¼šæ•°æ®äº§ç”Ÿä¸å¯¼å…¥
<ul><li><img src="https://static.lovedata.net/jpg/2018/6/14/1c7d68c6923522fa5c46adf289221e2f.jpg" alt="image"></li></ul></li> <li>æ¨¡å— 4ï¼šé•¿æ—¶å®¹é”™ æ•°æ®å®‰å…¨
<ul><li>executor
<ul><li>(1) çƒ­å¤‡ï¼š MEMORY_AND_DISK_2   MEMORY_ONLY_2</li> <li>(2) å†·å¤‡ï¼šå†·å¤‡æ˜¯æ¯æ¬¡å­˜å‚¨å—æ•°æ®å‰ï¼Œå…ˆæŠŠå—æ•°æ®ä½œä¸º log å†™å‡ºåˆ° WriteAheadLog é‡Œï¼Œå†å­˜å‚¨åˆ°æœ¬ executorã€‚executor å¤±æ•ˆæ—¶ï¼Œå°±ç”±å¦å¤–çš„ executor å»è¯» WALï¼Œå†é‡åš log æ¥æ¢å¤å—æ•°æ®ã€‚WAL é€šå¸¸å†™åˆ°å¯é å­˜å‚¨å¦‚ HDFS ä¸Šï¼Œæ‰€ä»¥æ¢å¤æ—¶å¯èƒ½éœ€è¦ä¸€æ®µ recover time</li> <li>(3) é‡æ”¾ï¼š kafka é‡æ”¾</li> <li>(4) å¿½ç•¥</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/31e647f87df8e5e9cf4790a53c2c8e23.jpg" alt="image"></li></ul></li> <li>driver ç«¯é•¿æ—¶å®¹é”™
<ul><li>å—æ•°æ®çš„ meta ä¿¡æ¯ä¸ŠæŠ¥åˆ° ReceiverTrackerï¼Œç„¶åäº¤ç»™ ReceivedBlockTracker åšå…·ä½“çš„ç®¡ç†ã€‚ReceivedBlockTracker ä¹Ÿé‡‡ç”¨ WAL å†·å¤‡æ–¹å¼è¿›è¡Œå¤‡ä»½ï¼Œåœ¨ driver å¤±æ•ˆåï¼Œç”±æ–°çš„ ReceivedBlockTracker è¯»å– WAL å¹¶æ¢å¤ block çš„ meta ä¿¡æ¯ã€‚</li></ul></li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/8db48d0ec7659a00e04dd6410f278cfc.jpg" alt="image"></li></ul></li></ul> <p><img src="https://static.lovedata.net/jpg/2018/6/14/d1d50e147a96b818046405f877daaddd.jpg" alt="image"></p> <h3 id="dstream-dstreamgraph-æ¶æ„åŸç†"><a href="#dstream-dstreamgraph-æ¶æ„åŸç†" class="header-anchor">#</a> DStream, DStreamGraph æ¶æ„åŸç†</h3> <ol><li>Spark Streaming çš„ æ¨¡å— 1 DAG é™æ€å®šä¹‰ è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æŠŠè®¡ç®—é€»è¾‘æè¿°ä¸ºä¸€ä¸ª RDD DAG çš„â€œæ¨¡æ¿â€ï¼Œåœ¨åé¢ Job åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸ª batchï¼Œéƒ½å°†æ ¹æ®è¿™ä¸ªâ€œæ¨¡æ¿â€ç”Ÿæˆä¸€ä¸ª RDD DAG çš„å®ä¾‹ã€‚</li> <li>è¿™ä¸ª RDD â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“çš„ç±»æ˜¯ DStreamï¼ŒRDD DAG â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“ç±»æ˜¯ DStreamGraphã€‚</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/8f248fec79f96bd8aa5eb7b04214c5bb.jpg" alt="image"></li> <li>RDD çš„å®šä¹‰æ˜¯ä¸€ä¸ªåªè¯»ã€åˆ†åŒºçš„æ•°æ®é›†ï¼ˆan RDD is a read-only, partitioned collection of recordsï¼‰ï¼Œè€Œ DStream åˆæ˜¯ RDD çš„æ¨¡æ¿ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠ Dstream ä¹Ÿè§†åŒæ•°æ®é›†</li> <li>ç”±å·²æœ‰çš„ DStream äº§ç”Ÿæ–° DStream çš„æ“ä½œç»Ÿç§° transformationã€‚ä¸€äº›å…¸å‹çš„ tansformation åŒ…æ‹¬ map(), filter(), reduce(), join() ç­‰ ã€‚</li> <li>å¦ä¸€äº› <strong>ä¸äº§ç”Ÿæ–°</strong> DStream æ•°æ®é›†ï¼Œè€Œæ˜¯åªåœ¨å·²æœ‰ DStream <strong>æ•°æ®é›†ä¸Šè¿›è¡Œçš„æ“ä½œå’Œè¾“å‡ºï¼Œç»Ÿç§°ä¸º</strong> <strong>output</strong> ã€‚æ¯”å¦‚ a.print() å°±ä¸ä¼šäº§ç”Ÿæ–°çš„æ•°æ®é›†ï¼Œè€Œæ˜¯åªæ˜¯å°† a çš„å†…å®¹æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥ print() å°±æ˜¯ä¸€ç§ output æ“ä½œã€‚ä¸€äº›å…¸å‹çš„ output åŒ…æ‹¬ print(), saveAsTextFiles(), saveAsHadoopFiles(), foreachRDD()</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/379be35f9037857f5531cf7d10fa486d.jpg" alt="image"></li> <li>æ€»ç»“ä¸€ä¸‹ï¼š
<ol><li>transformationï¼šå¯ä»¥çœ‹åˆ°åŸºæœ¬ä¸Š 1 ç§ transformation å°†å¯¹åº”äº§ç”Ÿä¸€ä¸ªæ–°çš„ DStream å­ç±»å®ä¾‹ï¼Œå¦‚ï¼š
.flatMap() å°†äº§ç”Ÿ FaltMappedDStream å®ä¾‹
.map() å°†äº§ç”Ÿ MappedDStream å®ä¾‹</li> <li>outputï¼šå°†åªäº§ç”Ÿä¸€ç§ ForEachDStream å­ç±»å®ä¾‹ï¼Œç”¨ä¸€ä¸ªå‡½æ•° func æ¥è®°å½•éœ€è¦åšçš„æ“ä½œ
å¦‚å¯¹äº print() å°±æ˜¯ï¼šfunc = cnt =&gt; cnt.print()</li></ol></li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/18341bbd7cc3323b903a114d01d3c524.jpg" alt="image"></li> <li>Spark Streaming åœ¨è¿›è¡Œç‰©ç†è®°å½•æ—¶å´æ˜¯åå‘ ç›¸åŒä¸RDD çš„å…ˆè®¡ç®—ä¸Šæ¸¸çš„æ€è·¯   DStream ä¹Ÿé‡‡ç”¨çš„åå‘è¡¨ç¤º æ‰€ä»¥ï¼Œè¿™é‡Œ d å¯¹ c çš„å¼•ç”¨ï¼Œè¡¨è¾¾çš„æ˜¯ä¸€ä¸ªä¸Šæ¸¸ä¾èµ–ï¼ˆdependencyï¼‰çš„å…³ç³»ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸æ±‚å€¼åˆ™å·²ï¼Œä¸€æ—¦ d.print() è¿™ä¸ª output æ“ä½œè§¦å‘äº†å¯¹ d çš„æ±‚å€¼ï¼Œé‚£ä¹ˆå°±éœ€è¦ä» d å¼€å§‹å¾€ä¸Šæ¸¸è¿›è¡Œè¿½æº¯è®¡ç®—ã€‚
<ol><li><img src="https://static.lovedata.net/jpg/2018/6/14/69b51ce16fdb7e073b0314474202bb8b.jpg" alt="image"></li></ol></li> <li>æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼š
<ul><li>(1) DStream é€»è¾‘ä¸Šé€šè¿‡ transformation æ¥å½¢æˆ DAGï¼Œä½†åœ¨ç‰©ç†ä¸Šå´æ˜¯é€šè¿‡ä¸ transformation åå‘çš„ä¾èµ–ï¼ˆdependencyï¼‰æ¥æ„æˆè¡¨ç¤ºçš„</li> <li>(2) å½“æŸä¸ªèŠ‚ç‚¹è°ƒç”¨äº† output æ“ä½œæ—¶ï¼Œå°±äº§ç”Ÿä¸€ä¸ªæ–°çš„ ForEachDStream ï¼Œè¿™ä¸ªæ–°çš„ ForEachDStream è®°å½•äº†å…·ä½“çš„ output æ“ä½œæ˜¯ä»€ä¹ˆ</li> <li>(3) åœ¨æ¯ä¸ª batch åŠ¨æ€ç”Ÿæˆ RDD å®ä¾‹æ—¶ï¼Œå°±å¯¹ (2) ä¸­æ–°ç”Ÿæˆçš„ DStream è¿›è¡Œ BFS éå†</li> <li>(4) Spark Streaming è®°å½•æ•´ä¸ª DStream DAG çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡ä¸€ä¸ª DStreamGraph å®ä¾‹è®°å½•äº†åˆ°æ‰€æœ‰çš„ output stream èŠ‚ç‚¹çš„å¼•ç”¨
é€šè¿‡å¯¹æ‰€æœ‰ output stream èŠ‚ç‚¹è¿›è¡Œéå†ï¼Œå°±å¯ä»¥å¾—åˆ°æ‰€æœ‰ä¸Šæ¸¸ä¾èµ–çš„ DStream
ä¸èƒ½è¢«éå†åˆ°çš„ DStream èŠ‚ç‚¹ â€”â€” å¦‚ g å’Œ h â€”â€” åˆ™è™½ç„¶å‡ºç°åœ¨äº†é€»è¾‘çš„ DAG ä¸­ï¼Œä½†æ˜¯å¹¶ä¸å±äºç‰©ç†çš„ DStreamGraphï¼Œä¹Ÿå°†åœ¨ Spark Streaming çš„å®é™…è¿è¡Œè¿‡ç¨‹ä¸­ä¸äº§ç”Ÿä»»ä½•ä½œç”¨</li> <li>(5) DStreamGraph å®ä¾‹åŒæ—¶ä¹Ÿè®°å½•äº†åˆ°æ‰€æœ‰ input stream èŠ‚ç‚¹çš„å¼•ç”¨
DStreamGraph æ—¶å¸¸éœ€è¦éå†æ²¡æœ‰ä¸Šæ¸¸ä¾èµ–çš„ DStream èŠ‚ç‚¹ â€”â€” ç§°ä¸º input stream â€”â€” è®°å½•ä¸€ä¸‹å°±å¯ä»¥é¿å…æ¯æ¬¡ä¸ºæŸ¥æ‰¾ input stream è€Œå¯¹ output steam è¿›è¡Œ BFS çš„æ¶ˆè€—</li></ul></li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/47a52951ef1abddc807788b5a6710b8d.jpg" alt="image"></li></ol> <p>å‚è€ƒ
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.1%20DStream%2C%20DStreamGraph%20%E8%AF%A6%E8%A7%A3.md" target="_blank" rel="noopener noreferrer">CoolplaySpark/1.1 DStream, DStreamGraph è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="dstream-ç”Ÿæˆ-rdd-çš„åŸç†"><a href="#dstream-ç”Ÿæˆ-rdd-çš„åŸç†" class="header-anchor">#</a> DStream ç”Ÿæˆ RDD çš„åŸç†</h3> <ol><li>Spark Streaming çš„ æ¨¡å— 1 DAG é™æ€å®šä¹‰ è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æŠŠè®¡ç®—é€»è¾‘æè¿°ä¸ºä¸€ä¸ª RDD DAG çš„â€œæ¨¡æ¿â€ï¼Œåœ¨åé¢ Job åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸ª batchï¼Œéƒ½å°†æ ¹æ®è¿™ä¸ªâ€œæ¨¡æ¿â€ç”Ÿæˆä¸€ä¸ª RDD DAG çš„å®ä¾‹ã€‚<img src="https://static.lovedata.net/jpg/2018/6/14/854a01530c476d05f6987ac329873022.jpg" alt="image"></li> <li>RDD â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“çš„ç±»æ˜¯ DStreamï¼ŒRDD DAG â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“ç±»æ˜¯ DStreamGraphã€‚</li> <li>DStream é€šè¿‡ generatedRDD ç®¡ç†å·²ç”Ÿæˆçš„ RDD
<ol><li>DStream å†…éƒ¨ç”¨ä¸€ä¸ªç±»å‹æ˜¯ HashMap çš„å˜é‡ generatedRDD æ¥è®°å½•å·²ç»ç”Ÿæˆè¿‡çš„ RDDï¼š</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/356a6d239b4011a2c2612a587c1e3560.jpg" alt="image"></li> <li>æ¯ä¸€ä¸ªä¸åŒçš„ DStream å®ä¾‹ï¼Œéƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ generatedRDD <img src="https://static.lovedata.net/jpg/2018/6/14/a704df7e8a3741d155cf29be66954f81.jpg" alt="image"></li></ol></li> <li>å®ç°
<ol><li>(a) InputDStream çš„ compute(time) å®ç°    1.
(1) å…ˆé€šè¿‡ä¸€ä¸ª findNewFiles() æ–¹æ³•ï¼Œæ‰¾åˆ° validTime ä»¥åäº§ç”Ÿçš„å¤šä¸ªæ–° file
(2) å¯¹æ¯ä¸ªæ–° fileï¼Œéƒ½å°†å…¶ä½œä¸ºå‚æ•°è°ƒç”¨ sc.newAPIHadoopFile(file)ï¼Œç”Ÿæˆä¸€ä¸ª RDD å®ä¾‹
(3) å°† (2) ä¸­çš„å¤šä¸ªæ–° file å¯¹åº”çš„å¤šä¸ª RDD å®ä¾‹è¿›è¡Œ unionï¼Œè¿”å›ä¸€ä¸ª union åçš„ UnionRDD</li> <li>(b) ä¸€èˆ¬ DStream çš„ compute(time) å®ç°
(1) è·å– parent DStream åœ¨æœ¬ batch é‡Œå¯¹åº”çš„ RDD å®ä¾‹
(2) åœ¨è¿™ä¸ª parent RDD å®ä¾‹ä¸Šï¼Œä»¥ mapFunc ä¸ºå‚æ•°è°ƒç”¨ .map(mapFunc) æ–¹æ³•ï¼Œå°†å¾—åˆ°çš„æ–° RDD å®ä¾‹è¿”å›
å®Œå…¨ç›¸å½“äºç”¨ RDD API å†™äº†è¿™æ ·çš„ä»£ç ï¼šreturn parentRDD.map(mapFunc)
æ€»ç»“ä¸Šé¢ MappedDStream å’Œ FilteredDStream çš„å®ç°ï¼Œå¯ä»¥çœ‹åˆ°ï¼š
DStream çš„ .map() æ“ä½œç”Ÿæˆäº† MappedDStreamï¼Œè€Œ MappedDStream åœ¨æ¯ä¸ª batch é‡Œç”Ÿæˆ RDD å®ä¾‹æ—¶ï¼Œå°†å¯¹ parentRDD è°ƒç”¨ RDD çš„ .map() æ“ä½œ â€”â€” DStream.map() æ“ä½œå®Œç¾å¤åˆ¶ä¸ºæ¯ä¸ª batch çš„ RDD.map() æ“ä½œ
DStream çš„ .filter() æ“ä½œç”Ÿæˆäº† FilteredDStreamï¼Œè€Œ FilteredDStream åœ¨æ¯ä¸ª batch é‡Œç”Ÿæˆ RDD å®ä¾‹æ—¶ï¼Œå°†å¯¹ parentRDD è°ƒç”¨ RDD çš„ .filter() æ“ä½œ â€”â€” DStream.filter() æ“ä½œå®Œç¾å¤åˆ¶ä¸ºæ¯ä¸ª batch çš„ RDD.filter() æ“ä½œ</li> <li>(c) ForEachDStream çš„ compute(time) å®ç°
(1) è·å– parent DStream åœ¨æœ¬ batch é‡Œå¯¹åº”çš„ RDD å®ä¾‹
(2) ä»¥è¿™ä¸ª parent RDD å’Œæœ¬æ¬¡ batch çš„ time ä¸ºå‚æ•°ï¼Œè°ƒç”¨ foreachFunc(parentRDD, time) æ–¹æ³•</li></ol></li></ol> <p>å‚è€ƒ
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.2%20DStream%20%E7%94%9F%E6%88%90%20RDD%20%E5%AE%9E%E4%BE%8B%E8%AF%A6%E8%A7%A3.md" target="_blank" rel="noopener noreferrer">CoolplaySpark/1.2 DStream ç”Ÿæˆ RDD å®ä¾‹è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="jobscheduler-job-jobset-åŸç†"><a href="#jobscheduler-job-jobset-åŸç†" class="header-anchor">#</a> JobScheduler, Job, JobSet åŸç†</h3> <ol><li>åœ¨ Spark Streaming ç¨‹åºåœ¨ ssc.start() å¼€å§‹è¿è¡Œæ—¶ï¼Œå°† JobScheduler çš„å®ä¾‹ç»™ start() è¿è¡Œèµ·æ¥ã€‚</li> <li>Spark Streaming çš„ Job æ€»è°ƒåº¦è€… JobScheduler
<ol><li>JobScheduler æ˜¯ Spark Streaming çš„ Job æ€»è°ƒåº¦è€…ã€‚</li> <li>JobScheduler æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„æˆå‘˜ï¼šJobGenerator å’Œ ReceiverTrackerã€‚JobScheduler å°†æ¯ä¸ª batch çš„ RDD DAG å…·ä½“ç”Ÿæˆå·¥ä½œå§”æ‰˜ç»™ JobGeneratorï¼Œè€Œå°†æºå¤´è¾“å…¥æ•°æ®çš„è®°å½•å·¥ä½œå§”æ‰˜ç»™ ReceiverTrackerã€‚</li> <li>JobGenerator ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå‘¨æœŸå°±æ˜¯æˆ‘ä»¬åˆšåˆšæåˆ°çš„ batchDurationï¼Œå®šæ—¶ä¸ºæ¯ä¸ª batch ç”Ÿæˆ RDD DAG çš„å®ä¾‹ DStreamGraph.generateJobs(time) å°†è¿”å›ä¸€ä¸ª Seq[Job]ï¼Œå…¶ä¸­çš„æ¯ä¸ª Job æ˜¯ä¸€ä¸ª ForEachDStream å®ä¾‹çš„ generateJob(time) è¿”å›çš„ç»“æœã€‚</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/db592ed6c11c4075d92d4ceb99866b5b.jpg" alt="image"></li> <li>å°±å°†å…¶åŒ…è£…æˆä¸€ä¸ª JobSetï¼ˆå¦‚ä¸Šå›¾ (3) ï¼‰ï¼Œç„¶åå°±è°ƒç”¨ JobScheduler.submitJobSet(jobSet) æ¥äº¤ä»˜å› JobScheduler</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/b8b45b6774686732cef2483d6ae3d86e.jpg" alt="image"></li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/2bddb82870c5fe3f8799fe0828bd9bdc.jpg" alt="image"></li> <li>JobHandler é™¤äº†åšä¸€äº›çŠ¶æ€è®°å½•å¤–ï¼Œæœ€ä¸»è¦çš„å°±æ˜¯è°ƒç”¨ job.run()</li></ol></li> <li>Spark Streaming çš„ JobSet, Jobï¼Œä¸ Spark Core çš„ Job, Stage, TaskSet, Task
<ol><li><img src="https://static.lovedata.net/jpg/2018/6/14/57491e55dcc5992b0b544fecdbd44292.jpg" alt="image"></li> <li>Spark Core çš„ Job, Stage, Task å°±æ˜¯æˆ‘ä»¬â€œæ—¥å¸¸â€è°ˆè®º Spark ä»»åŠ¡æ—¶æ‰€è¯´çš„é‚£äº›å«ä¹‰ï¼Œè€Œä¸”åœ¨ Spark çš„ WebUI ä¸Šæœ‰éå¸¸å¥½çš„ä½“ç°ï¼Œæ¯”å¦‚ä¸‹å›¾å°±æ˜¯ 1 ä¸ª Job åŒ…å« 3 ä¸ª Stageï¼›3 ä¸ª Stage å„åŒ…å« 8, 2, 4 ä¸ª Taskã€‚è€Œ TaskSet åˆ™æ˜¯ Spark Core çš„å†…éƒ¨ä»£ç é‡Œç”¨çš„ç±»ï¼Œæ˜¯ Task çš„é›†åˆï¼Œå’Œ Stage æ˜¯åŒä¹‰çš„ã€‚</li> <li>Spark Streaming é‡Œçš„ Job æ›´åƒæ˜¯ä¸ª Java é‡Œçš„ Runnableï¼Œå¯ä»¥ run() ä¸€ä¸ªè‡ªå®šä¹‰çš„ func å‡½æ•°ã€‚è€Œè¿™ä¸ª func, å¯ä»¥ï¼š
<ul><li>ç›´æ¥è°ƒç”¨ RDD çš„ actionï¼Œä»è€Œäº§ç”Ÿ 1 ä¸ªæˆ–å¤šä¸ª Spark Core çš„ Job</li> <li>å…ˆæ‰“å°ä¸€è¡Œè¡¨å¤´ï¼›ç„¶åè°ƒç”¨ firstTen = RDD.collect()ï¼Œå†æ‰“å° firstTen çš„å†…å®¹ï¼›æœ€åå†æ‰“å°ä¸€è¡Œè¡¨å°¾ â€”â€” è¿™æ­£æ˜¯ DStream.print() çš„ Job å®ç°</li> <li>ä¹Ÿå¯ä»¥æ˜¯ä»»ä½•ç”¨æˆ·å®šä¹‰çš„ codeï¼Œç”šè‡³æ•´ä¸ª Spark Streaming æ‰§è¡Œè¿‡ç¨‹éƒ½ä¸äº§ç”Ÿä»»ä½• Spark Core çš„ Job â€”â€” å¦‚ä¸Šä¸€å°èŠ‚æ‰€å±•ç¤ºçš„æµ‹è¯•ä»£ç ï¼Œå…¶ Job çš„ func å®ç°å°±æ˜¯ï¼šThread.sleep(Int.MaxValue)ï¼Œä»…ä»…æ˜¯ä¸ºäº†è®©è¿™ä¸ª Job ä¸€ç›´è·‘åœ¨ jobExecutor çº¿ç¨‹æ± é‡Œï¼Œä»è€Œæµ‹è¯• jobExecutor çš„å¹¶è¡Œåº¦ ğŸ˜ƒ</li></ul></li></ol></li></ol> <p>å‚è€ƒ
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/2.1%20JobScheduler%2C%20Job%2C%20JobSet%20%E8%AF%A6%E8%A7%A3.md" target="_blank" rel="noopener noreferrer">CoolplaySpark/2.1 JobScheduler, Job, JobSet è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="jobgenerator-åŸç†"><a href="#jobgenerator-åŸç†" class="header-anchor">#</a> JobGenerator åŸç†</h3> <ol><li><img src="https://static.lovedata.net/jpg/2018/6/14/d6c70b578147b38650a148e27262d1d6.jpg" alt="image"></li> <li>åœ¨å¯åŠ¨äº† RPC å¤„ç†çº¿ç¨‹ eventLoop åï¼Œå°±ä¼šæ ¹æ®æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦å­˜åœ¨ checkpointï¼Œæ¥å…·ä½“çš„å†³å®šæ˜¯ restart() è¿˜æ˜¯ startFirstTime()ã€‚</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/049cb705cae472db4447bab4f5b7a340.jpg" alt="image"></li> <li>å…ˆæ˜¯é€šè¿‡ graph.start() æ¥å‘ŠçŸ¥äº† DStreamGraph ç¬¬ 1 ä¸ª batch çš„å¯åŠ¨æ—¶é—´ï¼Œç„¶åå°±æ˜¯ timer.start() å¯åŠ¨äº†å…³é”®çš„å®šæ—¶å™¨ã€‚</li> <li>RecurringTimer
<ol><li>JobGenerator ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå‘¨æœŸå°±æ˜¯ç”¨æˆ·è®¾ç½®çš„ batchDurationï¼Œå®šæ—¶ä¸ºæ¯ä¸ª batch ç”Ÿæˆ RDD DAG çš„å®ä¾‹ã€‚</li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/ed1a17fad3d8c12b9f3c3d48ec0c8dd8.jpg" alt="image"></li> <li>æ•´ä¸ª timer çš„è°ƒåº¦å‘¨æœŸå°±æ˜¯ batchDurationï¼Œæ¯æ¬¡è°ƒåº¦èµ·æ¥å°±æ˜¯åšä¸€ä¸ªéå¸¸ç®€å•çš„å·¥ä½œï¼šå¾€ eventLoop é‡Œå‘é€ä¸€ä¸ªæ¶ˆæ¯ â€”â€” è¯¥ä¸ºå½“å‰ batch (new Time(longTime)) GenerateJobs äº†ï¼</li></ol></li> <li>GenerateJobs
<ol><li><img src="https://static.lovedata.net/jpg/2018/6/14/d520aabf0e670b3a357a85f995a992cc.jpg" alt="image"></li> <li>(1) è¦æ±‚ ReceiverTracker å°†ç›®å‰å·²æ”¶åˆ°çš„æ•°æ®è¿›è¡Œä¸€æ¬¡ allocateï¼Œå³å°†ä¸Šæ¬¡ batch åˆ‡åˆ†åçš„æ•°æ®åˆ‡åˆ†åˆ°åˆ°æœ¬æ¬¡æ–°çš„ batch é‡Œ</li> <li>(2) è¦æ±‚ DStreamGraph å¤åˆ¶å‡ºä¸€å¥—æ–°çš„ RDD DAG çš„å®ä¾‹ï¼Œå…·ä½“è¿‡ç¨‹æ˜¯ï¼šDStreamGraph å°†è¦æ±‚å›¾é‡Œçš„å°¾ DStream èŠ‚ç‚¹ç”Ÿæˆå…·ä½“çš„ RDD å®ä¾‹ï¼Œå¹¶é€’å½’çš„è°ƒç”¨å°¾ DStream çš„ä¸Šæ¸¸ DStream èŠ‚ç‚¹â€¦â€¦ä»¥æ­¤éå†æ•´ä¸ª DStreamGraphï¼Œéå†ç»“æŸä¹Ÿå°±æ­£å¥½ç”Ÿæˆäº† RDD DAG çš„å®ä¾‹</li> <li>(3) è·å–ç¬¬ 1 æ­¥ ReceiverTracker åˆ†é…åˆ°æœ¬ batch çš„æºå¤´æ•°æ®çš„ meta ä¿¡æ¯</li> <li>(4) å°†ç¬¬ 2 æ­¥ç”Ÿæˆçš„æœ¬ batch çš„ RDD DAGï¼Œå’Œç¬¬ 3 æ­¥è·å–åˆ°çš„ meta ä¿¡æ¯ï¼Œä¸€åŒæäº¤ç»™ JobScheduler å¼‚æ­¥æ‰§è¡Œ
<ol><li>è¿™é‡Œæˆ‘ä»¬æäº¤çš„æ˜¯å°† (a) time (b) Seq[job] (c) å—æ•°æ®çš„ meta ä¿¡æ¯ è¿™ä¸‰è€…åŒ…è£…ä¸ºä¸€ä¸ª JobSetï¼Œç„¶åè°ƒç”¨ JobScheduler.submitJobSet(JobSet) æäº¤ç»™ JobScheduler</li> <li>è¿™é‡Œçš„å‘ JobScheduler æäº¤è¿‡ç¨‹ä¸ JobScheduler æ¥ä¸‹æ¥åœ¨ jobExecutor é‡Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å¼‚æ­¥åˆ†ç¦»çš„ï¼Œå› æ­¤æœ¬æ­¥å°†éå¸¸å¿«å³å¯è¿”å›</li></ol></li> <li>(5) åªè¦æäº¤ç»“æŸï¼ˆä¸ç®¡æ˜¯å¦å·²å¼€å§‹å¼‚æ­¥æ‰§è¡Œï¼‰ï¼Œå°±é©¬ä¸Šå¯¹æ•´ä¸ªç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€åšä¸€ä¸ª checkpoint
<ul><li>è¿™é‡Œåš checkpoint ä¹Ÿåªæ˜¯å¼‚æ­¥æäº¤ä¸€ä¸ª DoCheckpoint æ¶ˆæ¯è¯·æ±‚ï¼Œä¸ç”¨ç­‰ checkpoint çœŸæ­£å†™å®Œæˆå³å¯è¿”å›</li> <li>è¿™é‡Œä¹Ÿç®€å•æè¿°ä¸€ä¸‹ checkpoint åŒ…å«çš„å†…å®¹ï¼ŒåŒ…æ‹¬å·²ç»æäº¤äº†çš„ã€ä½†å°šæœªè¿è¡Œç»“æŸçš„ JobSet ç­‰å®é™…è¿è¡Œæ—¶ä¿¡æ¯ã€‚</li></ul></li></ol></li> <li>æ•´ä¸ª DStreamGraph æ˜¯ç”± output stream é€šè¿‡ dependency å¼•ç”¨å…³ç³»ï¼Œç´¢å¼•åˆ°ä¸Šæ¸¸ DStream èŠ‚ç‚¹ã€‚è€Œé€’å½’çš„è¿½æº¯åˆ°æœ€ä¸Šæ¸¸çš„ InputDStream èŠ‚ç‚¹æ—¶ï¼Œå°±æ²¡æœ‰å¯¹å…¶å®ƒ DStream èŠ‚ç‚¹çš„ä¾èµ–äº†ï¼Œå› ä¸º InputDStream èŠ‚ç‚¹æœ¬èº«å°±ä»£è¡¨äº†æœ€åŸå§‹çš„æ•°æ®é›†ã€‚
<img src="https://static.lovedata.net/jpg/2018/6/14/47a52951ef1abddc807788b5a6710b8d.jpg" alt="image"></li></ol> <p>å‚è€ƒ
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/2.2%20JobGenerator%20%E8%AF%A6%E8%A7%A3.md" target="_blank" rel="noopener noreferrer">CoolplaySpark/2.2 JobGenerator è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="receiver-åˆ†å‘è¯¦è§£"><a href="#receiver-åˆ†å‘è¯¦è§£" class="header-anchor">#</a> Receiver åˆ†å‘è¯¦è§£</h3> <ol><li>ReceiverTracker è‡ªèº«è¿è¡Œåœ¨ driver ç«¯ï¼Œæ˜¯ä¸€ä¸ªç®¡ç†åˆ†å¸ƒåœ¨å„ä¸ª executor ä¸Šçš„ Receiver çš„æ€»æŒ‡æŒ¥è€…ã€‚åœ¨ ssc.start() æ—¶ï¼Œå°†éšå«åœ°è°ƒç”¨ ReceiverTracker.start()ï¼›è€Œ ReceiverTracker.start() æœ€é‡è¦çš„ä»»åŠ¡å°±æ˜¯è°ƒç”¨è‡ªå·±çš„ launchReceivers() æ–¹æ³•å°† Receiver åˆ†å‘åˆ°å¤šä¸ª executor ä¸Šå»ã€‚ç„¶ååœ¨æ¯ä¸ª executor ä¸Šï¼Œç”± ReceiverSupervisor æ¥åˆ†åˆ«å¯åŠ¨ä¸€ä¸ª Receiver æ¥æ”¶æ•°æ®
<img src="https://static.lovedata.net/jpg/2018/6/14/224b9ad7f4aa02d535ecc1a7930b84f6.jpg" alt="image"></li> <li>é€šè¿‡ 1 ä¸ª RDD å®ä¾‹åŒ…å« x ä¸ª Receiverï¼Œå¯¹åº”å¯åŠ¨ 1 ä¸ª Job åŒ…å« x ä¸ª Taskï¼Œå°±å¯ä»¥å®Œæˆ Receiver çš„åˆ†å‘å’Œéƒ¨ç½²äº†ã€‚ä¸Šè¿° (1.a)(1.b)(1.c)(2) çš„è¿‡ç¨‹ç¤ºæ„å¦‚ä¸‹å›¾ï¼š
<ol><li><img src="https://static.lovedata.net/jpg/2018/6/14/cb904de991c8e5292080411794978562.jpg" alt="image"></li></ol></li> <li>Spark 1.5.0 çš„ launchReceivers() å®ç°
<ol><li>ä» 1.5.0 å¼€å§‹ï¼ŒSpark Streaming æ·»åŠ äº†å¢å¼ºçš„ Receiver åˆ†å‘ç­–ç•¥ã€‚å¯¹æ¯”ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä¸»è¦çš„å˜æ›´åœ¨äºï¼š
æ·»åŠ å¯æ’æ‹”çš„ ReceiverSchedulingPolicy
æŠŠ 1 ä¸ª Jobï¼ˆåŒ…å« x ä¸ª Taskï¼‰ï¼Œæ”¹ä¸º x ä¸ª Jobï¼ˆæ¯ä¸ª Job åªåŒ…å« 1 ä¸ª Taskï¼‰
æ·»åŠ å¯¹ Receiver çš„ç›‘æ§é‡å¯æœºåˆ¶</li></ol></li></ol> <p>å‚è€ƒ
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/3.1%20Receiver%20%E5%88%86%E5%8F%91%E8%AF%A6%E8%A7%A3.md" target="_blank" rel="noopener noreferrer">CoolplaySpark/3.1 Receiver åˆ†å‘è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="receiver-receiversupervisor-blockgenerator-receivedblockhandler-è¯¦è§£"><a href="#receiver-receiversupervisor-blockgenerator-receivedblockhandler-è¯¦è§£" class="header-anchor">#</a> Receiver, ReceiverSupervisor, BlockGenerator, ReceivedBlockHandler è¯¦è§£</h3> <ol><li><p><img src="https://static.lovedata.net/jpg/2018/6/14/2a3cb6bdc7b04cb41c90c04a9b1e7d08.jpg" alt="image"></p></li> <li><p>ReceiverSupervisor å°†åœ¨ executor ç«¯ä½œä¸ºçš„ä¸»è¦è§’è‰²ï¼Œå¹¶ä¸”ï¼š</p> <p>(3) Receiver åœ¨ onStart() å¯åŠ¨åï¼Œå°±å°†æŒç»­ä¸æ–­åœ°æ¥æ”¶å¤–ç•Œæ•°æ®ï¼Œå¹¶æŒç»­äº¤ç»™ ReceiverSupervisor è¿›è¡Œæ•°æ®è½¬å‚¨ï¼›</p> <p>(4) ReceiverSupervisor æŒç»­ä¸æ–­åœ°æ¥æ”¶åˆ° Receiver è½¬æ¥çš„æ•°æ®ï¼š</p> <div class="language- extra-class"><pre><code> å¦‚æœæ•°æ®å¾ˆç»†å°ï¼Œå°±éœ€è¦ BlockGenerator æ”’å¤šæ¡æ•°æ®æˆä¸€å—(4a)ã€ç„¶åå†æˆå—å­˜å‚¨(4b æˆ– 4c)

 åä¹‹å°±ä¸ç”¨æ”’ï¼Œç›´æ¥æˆå—å­˜å‚¨(4b æˆ– 4c)

 è¿™é‡Œ Spark Streaming ç›®å‰æ”¯æŒä¸¤ç§æˆå—å­˜å‚¨æ–¹å¼ï¼Œä¸€ç§æ˜¯ç”± blockManagerskManagerBasedBlockHandler ç›´æ¥å­˜åˆ° executor çš„å†…å­˜æˆ–ç¡¬ç›˜ï¼Œå¦ä¸€ç§ç”± WriteAheadLogBasedBlockHandler æ˜¯åŒæ—¶å†™ WAL(4c) å’Œ executor çš„å†…å­˜æˆ–ç¡¬ç›˜
</code></pre></div><p>(5) æ¯æ¬¡æˆå—åœ¨ executor å­˜å‚¨å®Œæ¯•åï¼ŒReceiverSupervisor å°±ä¼šåŠæ—¶ä¸ŠæŠ¥å—æ•°æ®çš„ meta ä¿¡æ¯ç»™ driver ç«¯çš„ ReceiverTrackerï¼›è¿™é‡Œçš„ meta ä¿¡æ¯åŒ…æ‹¬æ•°æ®çš„æ ‡è¯† idï¼Œæ•°æ®çš„ä½ç½®ï¼Œæ•°æ®çš„æ¡æ•°ï¼Œæ•°æ®çš„å¤§å°ç­‰ä¿¡æ¯ã€‚</p> <p>(6) ReceiverTracker å†å°†æ”¶åˆ°çš„å—æ•°æ® meta ä¿¡æ¯ç›´æ¥è½¬ç»™è‡ªå·±çš„æˆå‘˜ ReceivedBlockTrackerï¼Œç”± ReceivedBlockTracker ä¸“é—¨ç®¡ç†æ”¶åˆ°çš„å—æ•°æ® meta ä¿¡æ¯ã€‚</p></li></ol> <p>å‚è€ƒ
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/3.2%20Receiver%2C%20ReceiverSupervisor%2C%20BlockGenerator%2C%20ReceivedBlockHandler%20%E8%AF%A6%E8%A7%A3.md" target="_blank" rel="noopener noreferrer">CoolplaySpark/3.2 Receiver, ReceiverSupervisor, BlockGenerator, ReceivedBlockHandler è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="receivertraker-receivedblocktracker-è¯¦è§£"><a href="#receivertraker-receivedblocktracker-è¯¦è§£" class="header-anchor">#</a> ReceiverTraker, ReceivedBlockTracker è¯¦è§£</h3> <ol><li><img src="https://static.lovedata.net/jpg/2018/6/14/f922757b3191a274fd1d7a0e6a9e6868.jpg" alt="image"></li> <li><img src="https://static.lovedata.net/jpg/2018/6/14/98d3fc9cb3c2a8acf556428ac2a8ace2.jpg" alt="image"></li></ol> <h3 id="å¸¸ç”¨åè¯ä»‹ç»"><a href="#å¸¸ç”¨åè¯ä»‹ç»" class="header-anchor">#</a> å¸¸ç”¨åè¯ä»‹ç»</h3> <ol><li>Dstream
<ol><li><img src="https://static.lovedata.net/jpg/2018/6/15/2b403056ff561e785fda3803acb7a8d0.jpg" alt="image"></li> <li><img src="https://static.lovedata.net/jpg/2018/6/15/f4986920bb874a1e97681025b19f8133.jpg" alt="image"></li> <li><img src="https://static.lovedata.net/jpg/2018/6/15/3d0a26d27d1edbc997f753f04640ac27.jpg" alt="image"></li> <li><img src="https://static.lovedata.net/jpg/2018/6/15/3136b9d092d4fbaaba9ded7fffde1943.jpg" alt="image"></li></ol></li></ol> <h3 id="ssä¸stormçš„å¯¹æ¯”"><a href="#ssä¸stormçš„å¯¹æ¯”" class="header-anchor">#</a> SSä¸Stormçš„å¯¹æ¯”</h3> <p><img src="https://static.lovedata.net/jpg/2018/6/19/d25e02bd208bec1aab06ccaeb47027f4.jpg" alt="image"> <img src="https://static.lovedata.net/jpg/2018/6/19/edfed7795fb19be856de49e138064267.jpg" alt="image"> <img src="https://static.lovedata.net/jpg/2018/6/19/179518a440011f913564852609cbf3e0.jpg" alt="image"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/pengshuangbao/databook/edit/master/docs/bigdata/spark/spark-streaming.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2023/4/14 16:56:47</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/bigdata/hadoop/å­¦ä¹ èµ„æº.html" class="prev">
        å­¦ä¹ èµ„æº
      </a></span> <span class="next"><a href="/bigdata/spark/spark.html">
        Spark
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.0f56a723.js" defer></script><script src="/assets/js/4.a8ef5668.js" defer></script><script src="/assets/js/119.09fec567.js" defer></script><script src="/assets/js/11.0473ae06.js" defer></script>
  </body>
</html>
