(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{578:function(e,a,t){"use strict";t.r(a);var r=t(14),i=Object(r.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"spark-streaming"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spark-streaming"}},[e._v("#")]),e._v(" Spark Streaming")]),e._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#spark-streaming-åŸºç¡€"}},[e._v("Spark Streaming åŸºç¡€")]),t("ul",[t("li",[t("a",{attrs:{href:"#spark-streamingå’Œstormæœ‰ä½•åŒºåˆ«-åº”ç”¨åœºæ™¯"}},[e._v("Spark Streamingå’ŒStormæœ‰ä½•åŒºåˆ«? åº”ç”¨åœºæ™¯?")])]),t("li",[t("a",{attrs:{href:"#spark-streaming-åŸç†"}},[e._v("Spark Streaming åŸç†")])]),t("li",[t("a",{attrs:{href:"#ss-æ•´ä½“æ¨¡å—"}},[e._v("SS æ•´ä½“æ¨¡å—")])]),t("li",[t("a",{attrs:{href:"#dstream-dstreamgraph-æ¶æ„åŸç†"}},[e._v("DStream, DStreamGraph æ¶æ„åŸç†")])]),t("li",[t("a",{attrs:{href:"#dstream-ç”Ÿæˆ-rdd-çš„åŸç†"}},[e._v("DStream ç”Ÿæˆ RDD çš„åŸç†")])]),t("li",[t("a",{attrs:{href:"#jobscheduler-job-jobset-åŸç†"}},[e._v("JobScheduler, Job, JobSet åŸç†")])]),t("li",[t("a",{attrs:{href:"#jobgenerator-åŸç†"}},[e._v("JobGenerator åŸç†")])]),t("li",[t("a",{attrs:{href:"#receiver-åˆ†å‘è¯¦è§£"}},[e._v("Receiver åˆ†å‘è¯¦è§£")])]),t("li",[t("a",{attrs:{href:"#receiver-receiversupervisor-blockgenerator-receivedblockhandler-è¯¦è§£"}},[e._v("Receiver, ReceiverSupervisor, BlockGenerator, ReceivedBlockHandler è¯¦è§£")])]),t("li",[t("a",{attrs:{href:"#receivertraker-receivedblocktracker-è¯¦è§£"}},[e._v("ReceiverTraker, ReceivedBlockTracker è¯¦è§£")])]),t("li",[t("a",{attrs:{href:"#å¸¸ç”¨åè¯ä»‹ç»"}},[e._v("å¸¸ç”¨åè¯ä»‹ç»")])]),t("li",[t("a",{attrs:{href:"#ssä¸stormçš„å¯¹æ¯”"}},[e._v("SSä¸Stormçš„å¯¹æ¯”")])])])])])]),t("p"),e._v(" "),t("h2",{attrs:{id:"spark-streaming-åŸºç¡€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spark-streaming-åŸºç¡€"}},[e._v("#")]),e._v(" Spark Streaming åŸºç¡€")]),e._v(" "),t("h3",{attrs:{id:"spark-streamingå’Œstormæœ‰ä½•åŒºåˆ«-åº”ç”¨åœºæ™¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spark-streamingå’Œstormæœ‰ä½•åŒºåˆ«-åº”ç”¨åœºæ™¯"}},[e._v("#")]),e._v(" Spark Streamingå’ŒStormæœ‰ä½•åŒºåˆ«? åº”ç”¨åœºæ™¯?")]),e._v(" "),t("h3",{attrs:{id:"spark-streaming-åŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spark-streaming-åŸç†"}},[e._v("#")]),e._v(" Spark Streaming åŸç†")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/4c10e84fe55db71e105e0a2a7c3ad10a.jpg",alt:"image"}}),e._v(" "),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/4cd553817fa7f91d206508dad84ded7a.jpg",alt:"image"}}),e._v(" "),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/854a01530c476d05f6987ac329873022.jpg",alt:"image"}}),e._v(" "),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/8c6963c0dfb3f36398c7b43a823889d6.jpg",alt:"image"}})]),e._v(" "),t("p",[e._v("å‚è€ƒ")]),e._v(" "),t("ol",[t("li",[t("a",{attrs:{href:"https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/0.1%20Spark%20Streaming%20%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%A8%A1%E5%9D%97%E6%A6%82%E8%BF%B0.md#24",target:"_blank",rel:"noopener noreferrer"}},[e._v("CoolplaySpark/0.1 Spark Streaming å®ç°æ€è·¯ä¸æ¨¡å—æ¦‚è¿°.md at master Â· lw-lin/CoolplaySpark Â· GitHub"),t("OutboundLink")],1)])]),e._v(" "),t("h3",{attrs:{id:"ss-æ•´ä½“æ¨¡å—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ss-æ•´ä½“æ¨¡å—"}},[e._v("#")]),e._v(" SS æ•´ä½“æ¨¡å—")]),e._v(" "),t("ul",[t("li",[e._v("æ¨¡å— 1ï¼šDAG é™æ€å®šä¹‰\n"),t("ul",[t("li",[e._v("åº”è¯¥é¦–å…ˆå¯¹è®¡ç®—é€»è¾‘æè¿°ä¸ºä¸€ä¸ª RDD DAG çš„â€œæ¨¡æ¿â€ï¼Œåœ¨åé¢ Job åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸ª batchï¼ŒSpark Streaming éƒ½å°†æ ¹æ®è¿™ä¸ªâ€œæ¨¡æ¿â€ç”Ÿæˆä¸€ä¸ª RDD DAG çš„å®ä¾‹ã€‚")]),e._v(" "),t("li",[e._v("DStream å’Œ RDD çš„å…³ç³»\n"),t("ul",[t("li",[e._v("DStream æ˜¯ RDD çš„æ¨¡æ¿ï¼Œè€Œä¸” DStream å’Œ RDD å…·æœ‰ç›¸åŒçš„ transformation æ“ä½œï¼Œæ¯”å¦‚ map(), filter(), reduce() â€¦â€¦ç­‰ç­‰ï¼ˆæ­£æ˜¯è¿™äº›ç›¸åŒçš„ transformation ä½¿å¾— DStreamGraph èƒ½å¤Ÿå¿ å®è®°å½• RDD DAG çš„è®¡ç®—é€»è¾‘ï¼‰")]),e._v(" "),t("li",[e._v("DStream ç»´æŠ¤äº†å¯¹æ¯ä¸ªäº§å‡ºçš„ RDD å®ä¾‹çš„å¼•ç”¨")]),e._v(" "),t("li",[e._v("å¯ä»¥è®¤ä¸ºï¼ŒRDD åŠ ä¸Š batch ç»´åº¦å°±æ˜¯ DStreamï¼ŒDStream å»æ‰ batch ç»´åº¦å°±æ˜¯ RDD â€”â€” å°±åƒ RDD = DStream at batch Tã€‚")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/a704df7e8a3741d155cf29be66954f81.jpg",alt:"image"}})]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/4084d7de41feac45d85e112841f3b5a5.jpg",alt:"Apache Storm  å’Œ storm ä¸åŒçš„åœ°æ–¹"}})])])])])]),e._v(" "),t("li",[e._v("æ¨¡å— 2ï¼šJob åŠ¨æ€ç”Ÿæˆ\n"),t("ul",[t("li",[e._v("åœ¨ Spark Streaming é‡Œï¼Œæ€»ä½“è´Ÿè´£åŠ¨æ€ä½œä¸šè°ƒåº¦çš„å…·ä½“ç±»æ˜¯ "),t("strong",[e._v("JobScheduler")]),e._v(" ï¼Œåœ¨ "),t("strong",[e._v("Spark Streaming ç¨‹åºå¼€å§‹è¿è¡Œçš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ª JobScheduler")]),e._v(" çš„å®ä¾‹ï¼Œå¹¶è¢«  "),t("strong",[e._v("start()")]),e._v(" è¿è¡Œèµ·æ¥")]),e._v(" "),t("li",[e._v("JobScheduler æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„æˆå‘˜ï¼šJobGenerator å’Œ ReceiverTrackerã€‚\n"),t("ul",[t("li",[e._v("JobScheduler å°†æ¯ä¸ª batch çš„ RDD DAG å…·ä½“ç”Ÿæˆå·¥ä½œå§”æ‰˜ç»™ "),t("strong",[e._v("JobGenerator")])]),e._v(" "),t("li",[e._v("è€Œå°†æºå¤´è¾“å…¥æ•°æ®çš„è®°å½•å·¥ä½œå§”æ‰˜ç»™ "),t("strong",[e._v("ReceiverTrackerã€‚")])])])]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/c9db933b1dfacee3182ebfe4321ab02a.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("JobGenerator ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå‘¨æœŸå°±æ˜¯æˆ‘ä»¬åˆšåˆšæåˆ°çš„ batchDurationï¼Œå®šæ—¶ä¸ºæ¯ä¸ª batch ç”Ÿæˆ RDD DAG çš„å®ä¾‹ã€‚\n"),t("ul",[t("li",[e._v("è¦æ±‚ ReceiverTracker å°†ç›®å‰å·²æ”¶åˆ°çš„æ•°æ®è¿›è¡Œä¸€æ¬¡ allocateï¼Œå³å°†ä¸Šæ¬¡ batch åˆ‡åˆ†åçš„æ•°æ®åˆ‡åˆ†åˆ°åˆ°æœ¬æ¬¡æ–°çš„ batch é‡Œï¼›")]),e._v(" "),t("li",[e._v("è¦æ±‚ DStreamGraph å¤åˆ¶å‡ºä¸€å¥—æ–°çš„ RDD DAG çš„å®ä¾‹ï¼Œå…·ä½“è¿‡ç¨‹æ˜¯ï¼šDStreamGraph å°†è¦æ±‚å›¾é‡Œçš„å°¾ DStream èŠ‚ç‚¹ç”Ÿæˆå…·ä½“çš„ RDD å®ä¾‹ï¼Œå¹¶é€’å½’çš„è°ƒç”¨å°¾ DStream çš„ä¸Šæ¸¸ DStream èŠ‚ç‚¹â€¦â€¦ä»¥æ­¤éå†æ•´ä¸ª DStreamGraphï¼Œéå†ç»“æŸä¹Ÿå°±æ­£å¥½ç”Ÿæˆäº† RDD DAG çš„å®ä¾‹ï¼›")]),e._v(" "),t("li",[e._v("è·å–ç¬¬ 1 æ­¥ ReceiverTracker åˆ†é…åˆ°æœ¬ batch çš„æºå¤´æ•°æ®çš„ meta ä¿¡æ¯ï¼›")]),e._v(" "),t("li",[e._v("å°†ç¬¬ 2 æ­¥ç”Ÿæˆçš„æœ¬ batch çš„ RDD DAGï¼Œå’Œç¬¬ 3 æ­¥è·å–åˆ°çš„ meta ä¿¡æ¯ï¼Œä¸€åŒæäº¤ç»™ JobScheduler å¼‚æ­¥æ‰§è¡Œï¼›")]),e._v(" "),t("li",[e._v("åªè¦æäº¤ç»“æŸï¼ˆä¸ç®¡æ˜¯å¦å·²å¼€å§‹å¼‚æ­¥æ‰§è¡Œï¼‰ï¼Œå°±é©¬ä¸Šå¯¹æ•´ä¸ªç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€åšä¸€ä¸ª checkpointã€‚")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/db592ed6c11c4075d92d4ceb99866b5b.jpg",alt:"image"}})])])])])]),e._v(" "),t("li",[e._v("æ¨¡å— 3ï¼šæ•°æ®äº§ç”Ÿä¸å¯¼å…¥\n"),t("ul",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/1c7d68c6923522fa5c46adf289221e2f.jpg",alt:"image"}})])])]),e._v(" "),t("li",[e._v("æ¨¡å— 4ï¼šé•¿æ—¶å®¹é”™ æ•°æ®å®‰å…¨\n"),t("ul",[t("li",[e._v("executor\n"),t("ul",[t("li",[e._v("(1) çƒ­å¤‡ï¼š MEMORY_AND_DISK_2   MEMORY_ONLY_2")]),e._v(" "),t("li",[e._v("(2) å†·å¤‡ï¼šå†·å¤‡æ˜¯æ¯æ¬¡å­˜å‚¨å—æ•°æ®å‰ï¼Œå…ˆæŠŠå—æ•°æ®ä½œä¸º log å†™å‡ºåˆ° WriteAheadLog é‡Œï¼Œå†å­˜å‚¨åˆ°æœ¬ executorã€‚executor å¤±æ•ˆæ—¶ï¼Œå°±ç”±å¦å¤–çš„ executor å»è¯» WALï¼Œå†é‡åš log æ¥æ¢å¤å—æ•°æ®ã€‚WAL é€šå¸¸å†™åˆ°å¯é å­˜å‚¨å¦‚ HDFS ä¸Šï¼Œæ‰€ä»¥æ¢å¤æ—¶å¯èƒ½éœ€è¦ä¸€æ®µ recover time")]),e._v(" "),t("li",[e._v("(3) é‡æ”¾ï¼š kafka é‡æ”¾")]),e._v(" "),t("li",[e._v("(4) å¿½ç•¥")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/31e647f87df8e5e9cf4790a53c2c8e23.jpg",alt:"image"}})])])]),e._v(" "),t("li",[e._v("driver ç«¯é•¿æ—¶å®¹é”™\n"),t("ul",[t("li",[e._v("å—æ•°æ®çš„ meta ä¿¡æ¯ä¸ŠæŠ¥åˆ° ReceiverTrackerï¼Œç„¶åäº¤ç»™ ReceivedBlockTracker åšå…·ä½“çš„ç®¡ç†ã€‚ReceivedBlockTracker ä¹Ÿé‡‡ç”¨ WAL å†·å¤‡æ–¹å¼è¿›è¡Œå¤‡ä»½ï¼Œåœ¨ driver å¤±æ•ˆåï¼Œç”±æ–°çš„ ReceivedBlockTracker è¯»å– WAL å¹¶æ¢å¤ block çš„ meta ä¿¡æ¯ã€‚")])])]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/8db48d0ec7659a00e04dd6410f278cfc.jpg",alt:"image"}})])])])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/d1d50e147a96b818046405f877daaddd.jpg",alt:"image"}})]),e._v(" "),t("h3",{attrs:{id:"dstream-dstreamgraph-æ¶æ„åŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dstream-dstreamgraph-æ¶æ„åŸç†"}},[e._v("#")]),e._v(" DStream, DStreamGraph æ¶æ„åŸç†")]),e._v(" "),t("ol",[t("li",[e._v("Spark Streaming çš„ æ¨¡å— 1 DAG é™æ€å®šä¹‰ è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æŠŠè®¡ç®—é€»è¾‘æè¿°ä¸ºä¸€ä¸ª RDD DAG çš„â€œæ¨¡æ¿â€ï¼Œåœ¨åé¢ Job åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸ª batchï¼Œéƒ½å°†æ ¹æ®è¿™ä¸ªâ€œæ¨¡æ¿â€ç”Ÿæˆä¸€ä¸ª RDD DAG çš„å®ä¾‹ã€‚")]),e._v(" "),t("li",[e._v("è¿™ä¸ª RDD â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“çš„ç±»æ˜¯ DStreamï¼ŒRDD DAG â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“ç±»æ˜¯ DStreamGraphã€‚")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/8f248fec79f96bd8aa5eb7b04214c5bb.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("RDD çš„å®šä¹‰æ˜¯ä¸€ä¸ªåªè¯»ã€åˆ†åŒºçš„æ•°æ®é›†ï¼ˆan RDD is a read-only, partitioned collection of recordsï¼‰ï¼Œè€Œ DStream åˆæ˜¯ RDD çš„æ¨¡æ¿ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠ Dstream ä¹Ÿè§†åŒæ•°æ®é›†")]),e._v(" "),t("li",[e._v("ç”±å·²æœ‰çš„ DStream äº§ç”Ÿæ–° DStream çš„æ“ä½œç»Ÿç§° transformationã€‚ä¸€äº›å…¸å‹çš„ tansformation åŒ…æ‹¬ map(), filter(), reduce(), join() ç­‰ ã€‚")]),e._v(" "),t("li",[e._v("å¦ä¸€äº› "),t("strong",[e._v("ä¸äº§ç”Ÿæ–°")]),e._v(" DStream æ•°æ®é›†ï¼Œè€Œæ˜¯åªåœ¨å·²æœ‰ DStream "),t("strong",[e._v("æ•°æ®é›†ä¸Šè¿›è¡Œçš„æ“ä½œå’Œè¾“å‡ºï¼Œç»Ÿç§°ä¸º")]),e._v(" "),t("strong",[e._v("output")]),e._v(" ã€‚æ¯”å¦‚ a.print() å°±ä¸ä¼šäº§ç”Ÿæ–°çš„æ•°æ®é›†ï¼Œè€Œæ˜¯åªæ˜¯å°† a çš„å†…å®¹æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥ print() å°±æ˜¯ä¸€ç§ output æ“ä½œã€‚ä¸€äº›å…¸å‹çš„ output åŒ…æ‹¬ print(), saveAsTextFiles(), saveAsHadoopFiles(), foreachRDD()")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/379be35f9037857f5531cf7d10fa486d.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("æ€»ç»“ä¸€ä¸‹ï¼š\n"),t("ol",[t("li",[e._v("transformationï¼šå¯ä»¥çœ‹åˆ°åŸºæœ¬ä¸Š 1 ç§ transformation å°†å¯¹åº”äº§ç”Ÿä¸€ä¸ªæ–°çš„ DStream å­ç±»å®ä¾‹ï¼Œå¦‚ï¼š\n.flatMap() å°†äº§ç”Ÿ FaltMappedDStream å®ä¾‹\n.map() å°†äº§ç”Ÿ MappedDStream å®ä¾‹")]),e._v(" "),t("li",[e._v("outputï¼šå°†åªäº§ç”Ÿä¸€ç§ ForEachDStream å­ç±»å®ä¾‹ï¼Œç”¨ä¸€ä¸ªå‡½æ•° func æ¥è®°å½•éœ€è¦åšçš„æ“ä½œ\nå¦‚å¯¹äº print() å°±æ˜¯ï¼šfunc = cnt => cnt.print()")])])]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/18341bbd7cc3323b903a114d01d3c524.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("Spark Streaming åœ¨è¿›è¡Œç‰©ç†è®°å½•æ—¶å´æ˜¯åå‘ ç›¸åŒä¸RDD çš„å…ˆè®¡ç®—ä¸Šæ¸¸çš„æ€è·¯   DStream ä¹Ÿé‡‡ç”¨çš„åå‘è¡¨ç¤º æ‰€ä»¥ï¼Œè¿™é‡Œ d å¯¹ c çš„å¼•ç”¨ï¼Œè¡¨è¾¾çš„æ˜¯ä¸€ä¸ªä¸Šæ¸¸ä¾èµ–ï¼ˆdependencyï¼‰çš„å…³ç³»ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸æ±‚å€¼åˆ™å·²ï¼Œä¸€æ—¦ d.print() è¿™ä¸ª output æ“ä½œè§¦å‘äº†å¯¹ d çš„æ±‚å€¼ï¼Œé‚£ä¹ˆå°±éœ€è¦ä» d å¼€å§‹å¾€ä¸Šæ¸¸è¿›è¡Œè¿½æº¯è®¡ç®—ã€‚\n"),t("ol",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/69b51ce16fdb7e073b0314474202bb8b.jpg",alt:"image"}})])])]),e._v(" "),t("li",[e._v("æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼š\n"),t("ul",[t("li",[e._v("(1) DStream é€»è¾‘ä¸Šé€šè¿‡ transformation æ¥å½¢æˆ DAGï¼Œä½†åœ¨ç‰©ç†ä¸Šå´æ˜¯é€šè¿‡ä¸ transformation åå‘çš„ä¾èµ–ï¼ˆdependencyï¼‰æ¥æ„æˆè¡¨ç¤ºçš„")]),e._v(" "),t("li",[e._v("(2) å½“æŸä¸ªèŠ‚ç‚¹è°ƒç”¨äº† output æ“ä½œæ—¶ï¼Œå°±äº§ç”Ÿä¸€ä¸ªæ–°çš„ ForEachDStream ï¼Œè¿™ä¸ªæ–°çš„ ForEachDStream è®°å½•äº†å…·ä½“çš„ output æ“ä½œæ˜¯ä»€ä¹ˆ")]),e._v(" "),t("li",[e._v("(3) åœ¨æ¯ä¸ª batch åŠ¨æ€ç”Ÿæˆ RDD å®ä¾‹æ—¶ï¼Œå°±å¯¹ (2) ä¸­æ–°ç”Ÿæˆçš„ DStream è¿›è¡Œ BFS éå†")]),e._v(" "),t("li",[e._v("(4) Spark Streaming è®°å½•æ•´ä¸ª DStream DAG çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡ä¸€ä¸ª DStreamGraph å®ä¾‹è®°å½•äº†åˆ°æ‰€æœ‰çš„ output stream èŠ‚ç‚¹çš„å¼•ç”¨\né€šè¿‡å¯¹æ‰€æœ‰ output stream èŠ‚ç‚¹è¿›è¡Œéå†ï¼Œå°±å¯ä»¥å¾—åˆ°æ‰€æœ‰ä¸Šæ¸¸ä¾èµ–çš„ DStream\nä¸èƒ½è¢«éå†åˆ°çš„ DStream èŠ‚ç‚¹ â€”â€” å¦‚ g å’Œ h â€”â€” åˆ™è™½ç„¶å‡ºç°åœ¨äº†é€»è¾‘çš„ DAG ä¸­ï¼Œä½†æ˜¯å¹¶ä¸å±äºç‰©ç†çš„ DStreamGraphï¼Œä¹Ÿå°†åœ¨ Spark Streaming çš„å®é™…è¿è¡Œè¿‡ç¨‹ä¸­ä¸äº§ç”Ÿä»»ä½•ä½œç”¨")]),e._v(" "),t("li",[e._v("(5) DStreamGraph å®ä¾‹åŒæ—¶ä¹Ÿè®°å½•äº†åˆ°æ‰€æœ‰ input stream èŠ‚ç‚¹çš„å¼•ç”¨\nDStreamGraph æ—¶å¸¸éœ€è¦éå†æ²¡æœ‰ä¸Šæ¸¸ä¾èµ–çš„ DStream èŠ‚ç‚¹ â€”â€” ç§°ä¸º input stream â€”â€” è®°å½•ä¸€ä¸‹å°±å¯ä»¥é¿å…æ¯æ¬¡ä¸ºæŸ¥æ‰¾ input stream è€Œå¯¹ output steam è¿›è¡Œ BFS çš„æ¶ˆè€—")])])]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/47a52951ef1abddc807788b5a6710b8d.jpg",alt:"image"}})])]),e._v(" "),t("p",[e._v("å‚è€ƒ\n"),t("a",{attrs:{href:"https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.1%20DStream%2C%20DStreamGraph%20%E8%AF%A6%E8%A7%A3.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("CoolplaySpark/1.1 DStream, DStreamGraph è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"dstream-ç”Ÿæˆ-rdd-çš„åŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dstream-ç”Ÿæˆ-rdd-çš„åŸç†"}},[e._v("#")]),e._v(" DStream ç”Ÿæˆ RDD çš„åŸç†")]),e._v(" "),t("ol",[t("li",[e._v("Spark Streaming çš„ æ¨¡å— 1 DAG é™æ€å®šä¹‰ è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æŠŠè®¡ç®—é€»è¾‘æè¿°ä¸ºä¸€ä¸ª RDD DAG çš„â€œæ¨¡æ¿â€ï¼Œåœ¨åé¢ Job åŠ¨æ€ç”Ÿæˆçš„æ—¶å€™ï¼Œé’ˆå¯¹æ¯ä¸ª batchï¼Œéƒ½å°†æ ¹æ®è¿™ä¸ªâ€œæ¨¡æ¿â€ç”Ÿæˆä¸€ä¸ª RDD DAG çš„å®ä¾‹ã€‚"),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/854a01530c476d05f6987ac329873022.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("RDD â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“çš„ç±»æ˜¯ DStreamï¼ŒRDD DAG â€œæ¨¡æ¿â€å¯¹åº”çš„å…·ä½“ç±»æ˜¯ DStreamGraphã€‚")]),e._v(" "),t("li",[e._v("DStream é€šè¿‡ generatedRDD ç®¡ç†å·²ç”Ÿæˆçš„ RDD\n"),t("ol",[t("li",[e._v("DStream å†…éƒ¨ç”¨ä¸€ä¸ªç±»å‹æ˜¯ HashMap çš„å˜é‡ generatedRDD æ¥è®°å½•å·²ç»ç”Ÿæˆè¿‡çš„ RDDï¼š")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/356a6d239b4011a2c2612a587c1e3560.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("æ¯ä¸€ä¸ªä¸åŒçš„ DStream å®ä¾‹ï¼Œéƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ generatedRDD "),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/a704df7e8a3741d155cf29be66954f81.jpg",alt:"image"}})])])]),e._v(" "),t("li",[e._v("å®ç°\n"),t("ol",[t("li",[e._v("(a) InputDStream çš„ compute(time) å®ç°    1.\n(1) å…ˆé€šè¿‡ä¸€ä¸ª findNewFiles() æ–¹æ³•ï¼Œæ‰¾åˆ° validTime ä»¥åäº§ç”Ÿçš„å¤šä¸ªæ–° file\n(2) å¯¹æ¯ä¸ªæ–° fileï¼Œéƒ½å°†å…¶ä½œä¸ºå‚æ•°è°ƒç”¨ sc.newAPIHadoopFile(file)ï¼Œç”Ÿæˆä¸€ä¸ª RDD å®ä¾‹\n(3) å°† (2) ä¸­çš„å¤šä¸ªæ–° file å¯¹åº”çš„å¤šä¸ª RDD å®ä¾‹è¿›è¡Œ unionï¼Œè¿”å›ä¸€ä¸ª union åçš„ UnionRDD")]),e._v(" "),t("li",[e._v("(b) ä¸€èˆ¬ DStream çš„ compute(time) å®ç°\n(1) è·å– parent DStream åœ¨æœ¬ batch é‡Œå¯¹åº”çš„ RDD å®ä¾‹\n(2) åœ¨è¿™ä¸ª parent RDD å®ä¾‹ä¸Šï¼Œä»¥ mapFunc ä¸ºå‚æ•°è°ƒç”¨ .map(mapFunc) æ–¹æ³•ï¼Œå°†å¾—åˆ°çš„æ–° RDD å®ä¾‹è¿”å›\nå®Œå…¨ç›¸å½“äºç”¨ RDD API å†™äº†è¿™æ ·çš„ä»£ç ï¼šreturn parentRDD.map(mapFunc)\næ€»ç»“ä¸Šé¢ MappedDStream å’Œ FilteredDStream çš„å®ç°ï¼Œå¯ä»¥çœ‹åˆ°ï¼š\nDStream çš„ .map() æ“ä½œç”Ÿæˆäº† MappedDStreamï¼Œè€Œ MappedDStream åœ¨æ¯ä¸ª batch é‡Œç”Ÿæˆ RDD å®ä¾‹æ—¶ï¼Œå°†å¯¹ parentRDD è°ƒç”¨ RDD çš„ .map() æ“ä½œ â€”â€” DStream.map() æ“ä½œå®Œç¾å¤åˆ¶ä¸ºæ¯ä¸ª batch çš„ RDD.map() æ“ä½œ\nDStream çš„ .filter() æ“ä½œç”Ÿæˆäº† FilteredDStreamï¼Œè€Œ FilteredDStream åœ¨æ¯ä¸ª batch é‡Œç”Ÿæˆ RDD å®ä¾‹æ—¶ï¼Œå°†å¯¹ parentRDD è°ƒç”¨ RDD çš„ .filter() æ“ä½œ â€”â€” DStream.filter() æ“ä½œå®Œç¾å¤åˆ¶ä¸ºæ¯ä¸ª batch çš„ RDD.filter() æ“ä½œ")]),e._v(" "),t("li",[e._v("(c) ForEachDStream çš„ compute(time) å®ç°\n(1) è·å– parent DStream åœ¨æœ¬ batch é‡Œå¯¹åº”çš„ RDD å®ä¾‹\n(2) ä»¥è¿™ä¸ª parent RDD å’Œæœ¬æ¬¡ batch çš„ time ä¸ºå‚æ•°ï¼Œè°ƒç”¨ foreachFunc(parentRDD, time) æ–¹æ³•")])])])]),e._v(" "),t("p",[e._v("å‚è€ƒ\n"),t("a",{attrs:{href:"https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.2%20DStream%20%E7%94%9F%E6%88%90%20RDD%20%E5%AE%9E%E4%BE%8B%E8%AF%A6%E8%A7%A3.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("CoolplaySpark/1.2 DStream ç”Ÿæˆ RDD å®ä¾‹è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"jobscheduler-job-jobset-åŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobscheduler-job-jobset-åŸç†"}},[e._v("#")]),e._v(" JobScheduler, Job, JobSet åŸç†")]),e._v(" "),t("ol",[t("li",[e._v("åœ¨ Spark Streaming ç¨‹åºåœ¨ ssc.start() å¼€å§‹è¿è¡Œæ—¶ï¼Œå°† JobScheduler çš„å®ä¾‹ç»™ start() è¿è¡Œèµ·æ¥ã€‚")]),e._v(" "),t("li",[e._v("Spark Streaming çš„ Job æ€»è°ƒåº¦è€… JobScheduler\n"),t("ol",[t("li",[e._v("JobScheduler æ˜¯ Spark Streaming çš„ Job æ€»è°ƒåº¦è€…ã€‚")]),e._v(" "),t("li",[e._v("JobScheduler æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„æˆå‘˜ï¼šJobGenerator å’Œ ReceiverTrackerã€‚JobScheduler å°†æ¯ä¸ª batch çš„ RDD DAG å…·ä½“ç”Ÿæˆå·¥ä½œå§”æ‰˜ç»™ JobGeneratorï¼Œè€Œå°†æºå¤´è¾“å…¥æ•°æ®çš„è®°å½•å·¥ä½œå§”æ‰˜ç»™ ReceiverTrackerã€‚")]),e._v(" "),t("li",[e._v("JobGenerator ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå‘¨æœŸå°±æ˜¯æˆ‘ä»¬åˆšåˆšæåˆ°çš„ batchDurationï¼Œå®šæ—¶ä¸ºæ¯ä¸ª batch ç”Ÿæˆ RDD DAG çš„å®ä¾‹ DStreamGraph.generateJobs(time) å°†è¿”å›ä¸€ä¸ª Seq[Job]ï¼Œå…¶ä¸­çš„æ¯ä¸ª Job æ˜¯ä¸€ä¸ª ForEachDStream å®ä¾‹çš„ generateJob(time) è¿”å›çš„ç»“æœã€‚")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/db592ed6c11c4075d92d4ceb99866b5b.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("å°±å°†å…¶åŒ…è£…æˆä¸€ä¸ª JobSetï¼ˆå¦‚ä¸Šå›¾ (3) ï¼‰ï¼Œç„¶åå°±è°ƒç”¨ JobScheduler.submitJobSet(jobSet) æ¥äº¤ä»˜å› JobScheduler")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/b8b45b6774686732cef2483d6ae3d86e.jpg",alt:"image"}})]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/2bddb82870c5fe3f8799fe0828bd9bdc.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("JobHandler é™¤äº†åšä¸€äº›çŠ¶æ€è®°å½•å¤–ï¼Œæœ€ä¸»è¦çš„å°±æ˜¯è°ƒç”¨ job.run()")])])]),e._v(" "),t("li",[e._v("Spark Streaming çš„ JobSet, Jobï¼Œä¸ Spark Core çš„ Job, Stage, TaskSet, Task\n"),t("ol",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/57491e55dcc5992b0b544fecdbd44292.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("Spark Core çš„ Job, Stage, Task å°±æ˜¯æˆ‘ä»¬â€œæ—¥å¸¸â€è°ˆè®º Spark ä»»åŠ¡æ—¶æ‰€è¯´çš„é‚£äº›å«ä¹‰ï¼Œè€Œä¸”åœ¨ Spark çš„ WebUI ä¸Šæœ‰éå¸¸å¥½çš„ä½“ç°ï¼Œæ¯”å¦‚ä¸‹å›¾å°±æ˜¯ 1 ä¸ª Job åŒ…å« 3 ä¸ª Stageï¼›3 ä¸ª Stage å„åŒ…å« 8, 2, 4 ä¸ª Taskã€‚è€Œ TaskSet åˆ™æ˜¯ Spark Core çš„å†…éƒ¨ä»£ç é‡Œç”¨çš„ç±»ï¼Œæ˜¯ Task çš„é›†åˆï¼Œå’Œ Stage æ˜¯åŒä¹‰çš„ã€‚")]),e._v(" "),t("li",[e._v("Spark Streaming é‡Œçš„ Job æ›´åƒæ˜¯ä¸ª Java é‡Œçš„ Runnableï¼Œå¯ä»¥ run() ä¸€ä¸ªè‡ªå®šä¹‰çš„ func å‡½æ•°ã€‚è€Œè¿™ä¸ª func, å¯ä»¥ï¼š\n"),t("ul",[t("li",[e._v("ç›´æ¥è°ƒç”¨ RDD çš„ actionï¼Œä»è€Œäº§ç”Ÿ 1 ä¸ªæˆ–å¤šä¸ª Spark Core çš„ Job")]),e._v(" "),t("li",[e._v("å…ˆæ‰“å°ä¸€è¡Œè¡¨å¤´ï¼›ç„¶åè°ƒç”¨ firstTen = RDD.collect()ï¼Œå†æ‰“å° firstTen çš„å†…å®¹ï¼›æœ€åå†æ‰“å°ä¸€è¡Œè¡¨å°¾ â€”â€” è¿™æ­£æ˜¯ DStream.print() çš„ Job å®ç°")]),e._v(" "),t("li",[e._v("ä¹Ÿå¯ä»¥æ˜¯ä»»ä½•ç”¨æˆ·å®šä¹‰çš„ codeï¼Œç”šè‡³æ•´ä¸ª Spark Streaming æ‰§è¡Œè¿‡ç¨‹éƒ½ä¸äº§ç”Ÿä»»ä½• Spark Core çš„ Job â€”â€” å¦‚ä¸Šä¸€å°èŠ‚æ‰€å±•ç¤ºçš„æµ‹è¯•ä»£ç ï¼Œå…¶ Job çš„ func å®ç°å°±æ˜¯ï¼šThread.sleep(Int.MaxValue)ï¼Œä»…ä»…æ˜¯ä¸ºäº†è®©è¿™ä¸ª Job ä¸€ç›´è·‘åœ¨ jobExecutor çº¿ç¨‹æ± é‡Œï¼Œä»è€Œæµ‹è¯• jobExecutor çš„å¹¶è¡Œåº¦ ğŸ˜ƒ")])])])])])]),e._v(" "),t("p",[e._v("å‚è€ƒ\n"),t("a",{attrs:{href:"https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/2.1%20JobScheduler%2C%20Job%2C%20JobSet%20%E8%AF%A6%E8%A7%A3.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("CoolplaySpark/2.1 JobScheduler, Job, JobSet è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"jobgenerator-åŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobgenerator-åŸç†"}},[e._v("#")]),e._v(" JobGenerator åŸç†")]),e._v(" "),t("ol",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/d6c70b578147b38650a148e27262d1d6.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("åœ¨å¯åŠ¨äº† RPC å¤„ç†çº¿ç¨‹ eventLoop åï¼Œå°±ä¼šæ ¹æ®æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦å­˜åœ¨ checkpointï¼Œæ¥å…·ä½“çš„å†³å®šæ˜¯ restart() è¿˜æ˜¯ startFirstTime()ã€‚")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/049cb705cae472db4447bab4f5b7a340.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("å…ˆæ˜¯é€šè¿‡ graph.start() æ¥å‘ŠçŸ¥äº† DStreamGraph ç¬¬ 1 ä¸ª batch çš„å¯åŠ¨æ—¶é—´ï¼Œç„¶åå°±æ˜¯ timer.start() å¯åŠ¨äº†å…³é”®çš„å®šæ—¶å™¨ã€‚")]),e._v(" "),t("li",[e._v("RecurringTimer\n"),t("ol",[t("li",[e._v("JobGenerator ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå‘¨æœŸå°±æ˜¯ç”¨æˆ·è®¾ç½®çš„ batchDurationï¼Œå®šæ—¶ä¸ºæ¯ä¸ª batch ç”Ÿæˆ RDD DAG çš„å®ä¾‹ã€‚")]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/ed1a17fad3d8c12b9f3c3d48ec0c8dd8.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("æ•´ä¸ª timer çš„è°ƒåº¦å‘¨æœŸå°±æ˜¯ batchDurationï¼Œæ¯æ¬¡è°ƒåº¦èµ·æ¥å°±æ˜¯åšä¸€ä¸ªéå¸¸ç®€å•çš„å·¥ä½œï¼šå¾€ eventLoop é‡Œå‘é€ä¸€ä¸ªæ¶ˆæ¯ â€”â€” è¯¥ä¸ºå½“å‰ batch (new Time(longTime)) GenerateJobs äº†ï¼")])])]),e._v(" "),t("li",[e._v("GenerateJobs\n"),t("ol",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/d520aabf0e670b3a357a85f995a992cc.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("(1) è¦æ±‚ ReceiverTracker å°†ç›®å‰å·²æ”¶åˆ°çš„æ•°æ®è¿›è¡Œä¸€æ¬¡ allocateï¼Œå³å°†ä¸Šæ¬¡ batch åˆ‡åˆ†åçš„æ•°æ®åˆ‡åˆ†åˆ°åˆ°æœ¬æ¬¡æ–°çš„ batch é‡Œ")]),e._v(" "),t("li",[e._v("(2) è¦æ±‚ DStreamGraph å¤åˆ¶å‡ºä¸€å¥—æ–°çš„ RDD DAG çš„å®ä¾‹ï¼Œå…·ä½“è¿‡ç¨‹æ˜¯ï¼šDStreamGraph å°†è¦æ±‚å›¾é‡Œçš„å°¾ DStream èŠ‚ç‚¹ç”Ÿæˆå…·ä½“çš„ RDD å®ä¾‹ï¼Œå¹¶é€’å½’çš„è°ƒç”¨å°¾ DStream çš„ä¸Šæ¸¸ DStream èŠ‚ç‚¹â€¦â€¦ä»¥æ­¤éå†æ•´ä¸ª DStreamGraphï¼Œéå†ç»“æŸä¹Ÿå°±æ­£å¥½ç”Ÿæˆäº† RDD DAG çš„å®ä¾‹")]),e._v(" "),t("li",[e._v("(3) è·å–ç¬¬ 1 æ­¥ ReceiverTracker åˆ†é…åˆ°æœ¬ batch çš„æºå¤´æ•°æ®çš„ meta ä¿¡æ¯")]),e._v(" "),t("li",[e._v("(4) å°†ç¬¬ 2 æ­¥ç”Ÿæˆçš„æœ¬ batch çš„ RDD DAGï¼Œå’Œç¬¬ 3 æ­¥è·å–åˆ°çš„ meta ä¿¡æ¯ï¼Œä¸€åŒæäº¤ç»™ JobScheduler å¼‚æ­¥æ‰§è¡Œ\n"),t("ol",[t("li",[e._v("è¿™é‡Œæˆ‘ä»¬æäº¤çš„æ˜¯å°† (a) time (b) Seq[job] (c) å—æ•°æ®çš„ meta ä¿¡æ¯ è¿™ä¸‰è€…åŒ…è£…ä¸ºä¸€ä¸ª JobSetï¼Œç„¶åè°ƒç”¨ JobScheduler.submitJobSet(JobSet) æäº¤ç»™ JobScheduler")]),e._v(" "),t("li",[e._v("è¿™é‡Œçš„å‘ JobScheduler æäº¤è¿‡ç¨‹ä¸ JobScheduler æ¥ä¸‹æ¥åœ¨ jobExecutor é‡Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å¼‚æ­¥åˆ†ç¦»çš„ï¼Œå› æ­¤æœ¬æ­¥å°†éå¸¸å¿«å³å¯è¿”å›")])])]),e._v(" "),t("li",[e._v("(5) åªè¦æäº¤ç»“æŸï¼ˆä¸ç®¡æ˜¯å¦å·²å¼€å§‹å¼‚æ­¥æ‰§è¡Œï¼‰ï¼Œå°±é©¬ä¸Šå¯¹æ•´ä¸ªç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€åšä¸€ä¸ª checkpoint\n"),t("ul",[t("li",[e._v("è¿™é‡Œåš checkpoint ä¹Ÿåªæ˜¯å¼‚æ­¥æäº¤ä¸€ä¸ª DoCheckpoint æ¶ˆæ¯è¯·æ±‚ï¼Œä¸ç”¨ç­‰ checkpoint çœŸæ­£å†™å®Œæˆå³å¯è¿”å›")]),e._v(" "),t("li",[e._v("è¿™é‡Œä¹Ÿç®€å•æè¿°ä¸€ä¸‹ checkpoint åŒ…å«çš„å†…å®¹ï¼ŒåŒ…æ‹¬å·²ç»æäº¤äº†çš„ã€ä½†å°šæœªè¿è¡Œç»“æŸçš„ JobSet ç­‰å®é™…è¿è¡Œæ—¶ä¿¡æ¯ã€‚")])])])])]),e._v(" "),t("li",[e._v("æ•´ä¸ª DStreamGraph æ˜¯ç”± output stream é€šè¿‡ dependency å¼•ç”¨å…³ç³»ï¼Œç´¢å¼•åˆ°ä¸Šæ¸¸ DStream èŠ‚ç‚¹ã€‚è€Œé€’å½’çš„è¿½æº¯åˆ°æœ€ä¸Šæ¸¸çš„ InputDStream èŠ‚ç‚¹æ—¶ï¼Œå°±æ²¡æœ‰å¯¹å…¶å®ƒ DStream èŠ‚ç‚¹çš„ä¾èµ–äº†ï¼Œå› ä¸º InputDStream èŠ‚ç‚¹æœ¬èº«å°±ä»£è¡¨äº†æœ€åŸå§‹çš„æ•°æ®é›†ã€‚\n"),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/47a52951ef1abddc807788b5a6710b8d.jpg",alt:"image"}})])]),e._v(" "),t("p",[e._v("å‚è€ƒ\n"),t("a",{attrs:{href:"https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/2.2%20JobGenerator%20%E8%AF%A6%E8%A7%A3.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("CoolplaySpark/2.2 JobGenerator è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"receiver-åˆ†å‘è¯¦è§£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#receiver-åˆ†å‘è¯¦è§£"}},[e._v("#")]),e._v(" Receiver åˆ†å‘è¯¦è§£")]),e._v(" "),t("ol",[t("li",[e._v("ReceiverTracker è‡ªèº«è¿è¡Œåœ¨ driver ç«¯ï¼Œæ˜¯ä¸€ä¸ªç®¡ç†åˆ†å¸ƒåœ¨å„ä¸ª executor ä¸Šçš„ Receiver çš„æ€»æŒ‡æŒ¥è€…ã€‚åœ¨ ssc.start() æ—¶ï¼Œå°†éšå«åœ°è°ƒç”¨ ReceiverTracker.start()ï¼›è€Œ ReceiverTracker.start() æœ€é‡è¦çš„ä»»åŠ¡å°±æ˜¯è°ƒç”¨è‡ªå·±çš„ launchReceivers() æ–¹æ³•å°† Receiver åˆ†å‘åˆ°å¤šä¸ª executor ä¸Šå»ã€‚ç„¶ååœ¨æ¯ä¸ª executor ä¸Šï¼Œç”± ReceiverSupervisor æ¥åˆ†åˆ«å¯åŠ¨ä¸€ä¸ª Receiver æ¥æ”¶æ•°æ®\n"),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/224b9ad7f4aa02d535ecc1a7930b84f6.jpg",alt:"image"}})]),e._v(" "),t("li",[e._v("é€šè¿‡ 1 ä¸ª RDD å®ä¾‹åŒ…å« x ä¸ª Receiverï¼Œå¯¹åº”å¯åŠ¨ 1 ä¸ª Job åŒ…å« x ä¸ª Taskï¼Œå°±å¯ä»¥å®Œæˆ Receiver çš„åˆ†å‘å’Œéƒ¨ç½²äº†ã€‚ä¸Šè¿° (1.a)(1.b)(1.c)(2) çš„è¿‡ç¨‹ç¤ºæ„å¦‚ä¸‹å›¾ï¼š\n"),t("ol",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/cb904de991c8e5292080411794978562.jpg",alt:"image"}})])])]),e._v(" "),t("li",[e._v("Spark 1.5.0 çš„ launchReceivers() å®ç°\n"),t("ol",[t("li",[e._v("ä» 1.5.0 å¼€å§‹ï¼ŒSpark Streaming æ·»åŠ äº†å¢å¼ºçš„ Receiver åˆ†å‘ç­–ç•¥ã€‚å¯¹æ¯”ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä¸»è¦çš„å˜æ›´åœ¨äºï¼š\næ·»åŠ å¯æ’æ‹”çš„ ReceiverSchedulingPolicy\næŠŠ 1 ä¸ª Jobï¼ˆåŒ…å« x ä¸ª Taskï¼‰ï¼Œæ”¹ä¸º x ä¸ª Jobï¼ˆæ¯ä¸ª Job åªåŒ…å« 1 ä¸ª Taskï¼‰\næ·»åŠ å¯¹ Receiver çš„ç›‘æ§é‡å¯æœºåˆ¶")])])])]),e._v(" "),t("p",[e._v("å‚è€ƒ\n"),t("a",{attrs:{href:"https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/3.1%20Receiver%20%E5%88%86%E5%8F%91%E8%AF%A6%E8%A7%A3.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("CoolplaySpark/3.1 Receiver åˆ†å‘è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"receiver-receiversupervisor-blockgenerator-receivedblockhandler-è¯¦è§£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#receiver-receiversupervisor-blockgenerator-receivedblockhandler-è¯¦è§£"}},[e._v("#")]),e._v(" Receiver, ReceiverSupervisor, BlockGenerator, ReceivedBlockHandler è¯¦è§£")]),e._v(" "),t("ol",[t("li",[t("p",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/2a3cb6bdc7b04cb41c90c04a9b1e7d08.jpg",alt:"image"}})])]),e._v(" "),t("li",[t("p",[e._v("ReceiverSupervisor å°†åœ¨ executor ç«¯ä½œä¸ºçš„ä¸»è¦è§’è‰²ï¼Œå¹¶ä¸”ï¼š")]),e._v(" "),t("p",[e._v("(3) Receiver åœ¨ onStart() å¯åŠ¨åï¼Œå°±å°†æŒç»­ä¸æ–­åœ°æ¥æ”¶å¤–ç•Œæ•°æ®ï¼Œå¹¶æŒç»­äº¤ç»™ ReceiverSupervisor è¿›è¡Œæ•°æ®è½¬å‚¨ï¼›")]),e._v(" "),t("p",[e._v("(4) ReceiverSupervisor æŒç»­ä¸æ–­åœ°æ¥æ”¶åˆ° Receiver è½¬æ¥çš„æ•°æ®ï¼š")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v(" å¦‚æœæ•°æ®å¾ˆç»†å°ï¼Œå°±éœ€è¦ BlockGenerator æ”’å¤šæ¡æ•°æ®æˆä¸€å—(4a)ã€ç„¶åå†æˆå—å­˜å‚¨(4b æˆ– 4c)\n\n åä¹‹å°±ä¸ç”¨æ”’ï¼Œç›´æ¥æˆå—å­˜å‚¨(4b æˆ– 4c)\n\n è¿™é‡Œ Spark Streaming ç›®å‰æ”¯æŒä¸¤ç§æˆå—å­˜å‚¨æ–¹å¼ï¼Œä¸€ç§æ˜¯ç”± blockManagerskManagerBasedBlockHandler ç›´æ¥å­˜åˆ° executor çš„å†…å­˜æˆ–ç¡¬ç›˜ï¼Œå¦ä¸€ç§ç”± WriteAheadLogBasedBlockHandler æ˜¯åŒæ—¶å†™ WAL(4c) å’Œ executor çš„å†…å­˜æˆ–ç¡¬ç›˜\n")])])]),t("p",[e._v("(5) æ¯æ¬¡æˆå—åœ¨ executor å­˜å‚¨å®Œæ¯•åï¼ŒReceiverSupervisor å°±ä¼šåŠæ—¶ä¸ŠæŠ¥å—æ•°æ®çš„ meta ä¿¡æ¯ç»™ driver ç«¯çš„ ReceiverTrackerï¼›è¿™é‡Œçš„ meta ä¿¡æ¯åŒ…æ‹¬æ•°æ®çš„æ ‡è¯† idï¼Œæ•°æ®çš„ä½ç½®ï¼Œæ•°æ®çš„æ¡æ•°ï¼Œæ•°æ®çš„å¤§å°ç­‰ä¿¡æ¯ã€‚")]),e._v(" "),t("p",[e._v("(6) ReceiverTracker å†å°†æ”¶åˆ°çš„å—æ•°æ® meta ä¿¡æ¯ç›´æ¥è½¬ç»™è‡ªå·±çš„æˆå‘˜ ReceivedBlockTrackerï¼Œç”± ReceivedBlockTracker ä¸“é—¨ç®¡ç†æ”¶åˆ°çš„å—æ•°æ® meta ä¿¡æ¯ã€‚")])])]),e._v(" "),t("p",[e._v("å‚è€ƒ\n"),t("a",{attrs:{href:"https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/3.2%20Receiver%2C%20ReceiverSupervisor%2C%20BlockGenerator%2C%20ReceivedBlockHandler%20%E8%AF%A6%E8%A7%A3.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("CoolplaySpark/3.2 Receiver, ReceiverSupervisor, BlockGenerator, ReceivedBlockHandler è¯¦è§£.md at master Â· lw-lin/CoolplaySpark Â· GitHub"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"receivertraker-receivedblocktracker-è¯¦è§£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#receivertraker-receivedblocktracker-è¯¦è§£"}},[e._v("#")]),e._v(" ReceiverTraker, ReceivedBlockTracker è¯¦è§£")]),e._v(" "),t("ol",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/f922757b3191a274fd1d7a0e6a9e6868.jpg",alt:"image"}})]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/14/98d3fc9cb3c2a8acf556428ac2a8ace2.jpg",alt:"image"}})])]),e._v(" "),t("h3",{attrs:{id:"å¸¸ç”¨åè¯ä»‹ç»"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¸¸ç”¨åè¯ä»‹ç»"}},[e._v("#")]),e._v(" å¸¸ç”¨åè¯ä»‹ç»")]),e._v(" "),t("ol",[t("li",[e._v("Dstream\n"),t("ol",[t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/15/2b403056ff561e785fda3803acb7a8d0.jpg",alt:"image"}})]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/15/f4986920bb874a1e97681025b19f8133.jpg",alt:"image"}})]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/15/3d0a26d27d1edbc997f753f04640ac27.jpg",alt:"image"}})]),e._v(" "),t("li",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/15/3136b9d092d4fbaaba9ded7fffde1943.jpg",alt:"image"}})])])])]),e._v(" "),t("h3",{attrs:{id:"ssä¸stormçš„å¯¹æ¯”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssä¸stormçš„å¯¹æ¯”"}},[e._v("#")]),e._v(" SSä¸Stormçš„å¯¹æ¯”")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/19/d25e02bd208bec1aab06ccaeb47027f4.jpg",alt:"image"}}),e._v(" "),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/19/edfed7795fb19be856de49e138064267.jpg",alt:"image"}}),e._v(" "),t("img",{attrs:{src:"https://static.lovedata.net/jpg/2018/6/19/179518a440011f913564852609cbf3e0.jpg",alt:"image"}})])])}),[],!1,null,null,null);a.default=i.exports}}]);