<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>多线程 | 编程手册</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="苍穹浩渺,取之须臾">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.225a8ff9.css" as="style"><link rel="preload" href="/assets/js/app.0f56a723.js" as="script"><link rel="preload" href="/assets/js/4.a8ef5668.js" as="script"><link rel="preload" href="/assets/js/177.ba85b912.js" as="script"><link rel="preload" href="/assets/js/11.0473ae06.js" as="script"><link rel="prefetch" href="/assets/js/10.06cc4fbb.js"><link rel="prefetch" href="/assets/js/100.79e96d05.js"><link rel="prefetch" href="/assets/js/101.bcac0b9f.js"><link rel="prefetch" href="/assets/js/102.c5d92a95.js"><link rel="prefetch" href="/assets/js/103.697856ab.js"><link rel="prefetch" href="/assets/js/104.8f2db4d2.js"><link rel="prefetch" href="/assets/js/105.d4f2bb07.js"><link rel="prefetch" href="/assets/js/106.1a533c3f.js"><link rel="prefetch" href="/assets/js/107.b2845ea0.js"><link rel="prefetch" href="/assets/js/108.226e46ed.js"><link rel="prefetch" href="/assets/js/109.0de9c16c.js"><link rel="prefetch" href="/assets/js/110.4657c34b.js"><link rel="prefetch" href="/assets/js/111.3409d3a7.js"><link rel="prefetch" href="/assets/js/112.a46b486c.js"><link rel="prefetch" href="/assets/js/113.ba001fa9.js"><link rel="prefetch" href="/assets/js/114.ad1e6ba1.js"><link rel="prefetch" href="/assets/js/115.a0ac732f.js"><link rel="prefetch" href="/assets/js/116.4ee2a7b2.js"><link rel="prefetch" href="/assets/js/117.a76fd29a.js"><link rel="prefetch" href="/assets/js/118.83c5badf.js"><link rel="prefetch" href="/assets/js/119.09fec567.js"><link rel="prefetch" href="/assets/js/12.286e979d.js"><link rel="prefetch" href="/assets/js/120.42120fe1.js"><link rel="prefetch" href="/assets/js/121.9d79a9dd.js"><link rel="prefetch" href="/assets/js/122.f71a459c.js"><link rel="prefetch" href="/assets/js/123.b75308dc.js"><link rel="prefetch" href="/assets/js/124.e4d4643b.js"><link rel="prefetch" href="/assets/js/125.73fc990d.js"><link rel="prefetch" href="/assets/js/126.3b0eccd0.js"><link rel="prefetch" href="/assets/js/127.3eb3ab27.js"><link rel="prefetch" href="/assets/js/128.64ba68bb.js"><link rel="prefetch" href="/assets/js/129.82cfac7a.js"><link rel="prefetch" href="/assets/js/13.7207d991.js"><link rel="prefetch" href="/assets/js/130.42811f32.js"><link rel="prefetch" href="/assets/js/131.6f498e16.js"><link rel="prefetch" href="/assets/js/132.f0cc9ad2.js"><link rel="prefetch" href="/assets/js/133.325e755a.js"><link rel="prefetch" href="/assets/js/134.076a808c.js"><link rel="prefetch" href="/assets/js/135.fad7be83.js"><link rel="prefetch" href="/assets/js/136.042fc555.js"><link rel="prefetch" href="/assets/js/137.b67b55bc.js"><link rel="prefetch" href="/assets/js/138.6476c99f.js"><link rel="prefetch" href="/assets/js/139.ad07500f.js"><link rel="prefetch" href="/assets/js/14.a1cb7c1b.js"><link rel="prefetch" href="/assets/js/140.3edd2237.js"><link rel="prefetch" href="/assets/js/141.5181db27.js"><link rel="prefetch" href="/assets/js/142.67b4c4a2.js"><link rel="prefetch" href="/assets/js/143.9d249a3f.js"><link rel="prefetch" href="/assets/js/144.e6db5540.js"><link rel="prefetch" href="/assets/js/145.5b4305a7.js"><link rel="prefetch" href="/assets/js/146.bc674178.js"><link rel="prefetch" href="/assets/js/147.964ff3df.js"><link rel="prefetch" href="/assets/js/148.570b6864.js"><link rel="prefetch" href="/assets/js/149.4b9796c2.js"><link rel="prefetch" href="/assets/js/15.3cafda64.js"><link rel="prefetch" href="/assets/js/150.c677bf4b.js"><link rel="prefetch" href="/assets/js/151.b8977c93.js"><link rel="prefetch" href="/assets/js/152.535e2db4.js"><link rel="prefetch" href="/assets/js/153.754fc05e.js"><link rel="prefetch" href="/assets/js/154.5a5928b6.js"><link rel="prefetch" href="/assets/js/155.19893ca5.js"><link rel="prefetch" href="/assets/js/156.da1f2665.js"><link rel="prefetch" href="/assets/js/157.cb7b551f.js"><link rel="prefetch" href="/assets/js/158.f5d94a11.js"><link rel="prefetch" href="/assets/js/159.0b2b78d9.js"><link rel="prefetch" href="/assets/js/16.54ab9242.js"><link rel="prefetch" href="/assets/js/160.c2548b6c.js"><link rel="prefetch" href="/assets/js/161.8f694ed1.js"><link rel="prefetch" href="/assets/js/162.1adc1aa4.js"><link rel="prefetch" href="/assets/js/163.5688827c.js"><link rel="prefetch" href="/assets/js/164.8442474f.js"><link rel="prefetch" href="/assets/js/165.d0e21e5c.js"><link rel="prefetch" href="/assets/js/166.2e90ae99.js"><link rel="prefetch" href="/assets/js/167.374185de.js"><link rel="prefetch" href="/assets/js/168.2426769f.js"><link rel="prefetch" href="/assets/js/169.829516d9.js"><link rel="prefetch" href="/assets/js/17.9cad59f9.js"><link rel="prefetch" href="/assets/js/170.db0c4609.js"><link rel="prefetch" href="/assets/js/171.7bdcc41b.js"><link rel="prefetch" href="/assets/js/172.7f7ab109.js"><link rel="prefetch" href="/assets/js/173.c1d51df9.js"><link rel="prefetch" href="/assets/js/174.afa4c5f6.js"><link rel="prefetch" href="/assets/js/175.b46d9dd8.js"><link rel="prefetch" href="/assets/js/176.c38ba756.js"><link rel="prefetch" href="/assets/js/178.af1a44e8.js"><link rel="prefetch" href="/assets/js/179.e097e164.js"><link rel="prefetch" href="/assets/js/18.3776b09c.js"><link rel="prefetch" href="/assets/js/180.d9d5d80c.js"><link rel="prefetch" href="/assets/js/181.79401f8c.js"><link rel="prefetch" href="/assets/js/182.343db47f.js"><link rel="prefetch" href="/assets/js/183.005841bb.js"><link rel="prefetch" href="/assets/js/19.d0ac1e7f.js"><link rel="prefetch" href="/assets/js/20.e0100fb2.js"><link rel="prefetch" href="/assets/js/21.f59cd52c.js"><link rel="prefetch" href="/assets/js/22.3ecf54da.js"><link rel="prefetch" href="/assets/js/23.2508850b.js"><link rel="prefetch" href="/assets/js/24.0ac10322.js"><link rel="prefetch" href="/assets/js/25.7c3ee156.js"><link rel="prefetch" href="/assets/js/26.7021c42c.js"><link rel="prefetch" href="/assets/js/27.d716476b.js"><link rel="prefetch" href="/assets/js/28.58ebf808.js"><link rel="prefetch" href="/assets/js/29.88c37f6c.js"><link rel="prefetch" href="/assets/js/30.87bc4a91.js"><link rel="prefetch" href="/assets/js/31.a69c2a35.js"><link rel="prefetch" href="/assets/js/32.89f74912.js"><link rel="prefetch" href="/assets/js/33.df886872.js"><link rel="prefetch" href="/assets/js/34.835d0785.js"><link rel="prefetch" href="/assets/js/35.5e38ab06.js"><link rel="prefetch" href="/assets/js/36.5b639051.js"><link rel="prefetch" href="/assets/js/37.bb32ead0.js"><link rel="prefetch" href="/assets/js/38.c2541da0.js"><link rel="prefetch" href="/assets/js/39.3c8f0f06.js"><link rel="prefetch" href="/assets/js/40.4cc077aa.js"><link rel="prefetch" href="/assets/js/41.cbcd81a7.js"><link rel="prefetch" href="/assets/js/42.6d002f78.js"><link rel="prefetch" href="/assets/js/43.3f67c882.js"><link rel="prefetch" href="/assets/js/44.58ce7a4d.js"><link rel="prefetch" href="/assets/js/45.bfb9d6e0.js"><link rel="prefetch" href="/assets/js/46.691097de.js"><link rel="prefetch" href="/assets/js/47.e6b5c9b5.js"><link rel="prefetch" href="/assets/js/48.38159f5c.js"><link rel="prefetch" href="/assets/js/49.e03ce66a.js"><link rel="prefetch" href="/assets/js/5.340b4b76.js"><link rel="prefetch" href="/assets/js/50.7df345cb.js"><link rel="prefetch" href="/assets/js/51.b3eed5d5.js"><link rel="prefetch" href="/assets/js/52.bb282842.js"><link rel="prefetch" href="/assets/js/53.6b21ec8f.js"><link rel="prefetch" href="/assets/js/54.bab98944.js"><link rel="prefetch" href="/assets/js/55.59437904.js"><link rel="prefetch" href="/assets/js/56.18b88131.js"><link rel="prefetch" href="/assets/js/57.b0cbba56.js"><link rel="prefetch" href="/assets/js/58.d9379002.js"><link rel="prefetch" href="/assets/js/59.e8663882.js"><link rel="prefetch" href="/assets/js/6.c48e1ddb.js"><link rel="prefetch" href="/assets/js/60.0a00b724.js"><link rel="prefetch" href="/assets/js/61.cd09980d.js"><link rel="prefetch" href="/assets/js/62.b092ff62.js"><link rel="prefetch" href="/assets/js/63.86482c79.js"><link rel="prefetch" href="/assets/js/64.3c1ee4d2.js"><link rel="prefetch" href="/assets/js/65.0621decf.js"><link rel="prefetch" href="/assets/js/66.cf7a6241.js"><link rel="prefetch" href="/assets/js/67.99e103bc.js"><link rel="prefetch" href="/assets/js/68.b3589f28.js"><link rel="prefetch" href="/assets/js/69.f0932a12.js"><link rel="prefetch" href="/assets/js/7.0f410b85.js"><link rel="prefetch" href="/assets/js/70.0a941773.js"><link rel="prefetch" href="/assets/js/71.3a6c6141.js"><link rel="prefetch" href="/assets/js/72.2299ff58.js"><link rel="prefetch" href="/assets/js/73.544fe8c6.js"><link rel="prefetch" href="/assets/js/74.98219c05.js"><link rel="prefetch" href="/assets/js/75.244a9d80.js"><link rel="prefetch" href="/assets/js/76.cefd9fe2.js"><link rel="prefetch" href="/assets/js/77.59793840.js"><link rel="prefetch" href="/assets/js/78.a7d9a079.js"><link rel="prefetch" href="/assets/js/79.f9ec013d.js"><link rel="prefetch" href="/assets/js/8.269955a4.js"><link rel="prefetch" href="/assets/js/80.b0f2cbe5.js"><link rel="prefetch" href="/assets/js/81.3d245e9a.js"><link rel="prefetch" href="/assets/js/82.061b170d.js"><link rel="prefetch" href="/assets/js/83.d2c42148.js"><link rel="prefetch" href="/assets/js/84.f6f487a4.js"><link rel="prefetch" href="/assets/js/85.c5305650.js"><link rel="prefetch" href="/assets/js/86.0c30a2ef.js"><link rel="prefetch" href="/assets/js/87.d9a99f2e.js"><link rel="prefetch" href="/assets/js/88.03792030.js"><link rel="prefetch" href="/assets/js/89.95684850.js"><link rel="prefetch" href="/assets/js/9.5c3462fb.js"><link rel="prefetch" href="/assets/js/90.185b012e.js"><link rel="prefetch" href="/assets/js/91.d19f0020.js"><link rel="prefetch" href="/assets/js/92.9e7855de.js"><link rel="prefetch" href="/assets/js/93.1ee902df.js"><link rel="prefetch" href="/assets/js/94.4bfab4ad.js"><link rel="prefetch" href="/assets/js/95.5f0b1d15.js"><link rel="prefetch" href="/assets/js/96.bd50a446.js"><link rel="prefetch" href="/assets/js/97.749fd671.js"><link rel="prefetch" href="/assets/js/98.bc09c746.js"><link rel="prefetch" href="/assets/js/99.40f98e75.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.98d8c7d3.js"><link rel="prefetch" href="/assets/js/vendors~notification.5515ddcd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.225a8ff9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">编程手册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link router-link-active">
  Java
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法 
</a></div><div class="nav-item"><a href="/architecture/" class="nav-link">
  架构 
</a></div><div class="nav-item"><a href="/computer/" class="nav-link">
  计算机 
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  数据库 
</a></div><div class="nav-item"><a href="/fe/" class="nav-link">
  前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维 " class="dropdown-title"><span class="title">运维 </span> <span class="arrow down"></span></button> <button type="button" aria-label="运维 " class="mobile-dropdown-title"><span class="title">运维 </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ops/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><h4>
          分类
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ops/java.html" class="nav-link">
  Java
</a></li><li class="dropdown-subitem"><a href="/ops/bigdata.html" class="nav-link">
  大数据
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><span class="title">编程</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程" class="mobile-dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/programming/python.html" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/programming/scala.html" class="nav-link">
  Scala
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源" class="dropdown-title"><span class="title">资源</span> <span class="arrow down"></span></button> <button type="button" aria-label="资源" class="mobile-dropdown-title"><span class="title">资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          我的书单
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/tech.html" class="nav-link">
  技术类
</a></li><li class="dropdown-subitem"><a href="/book/growth.html" class="nav-link">
  成长类
</a></li></ul></li><li class="dropdown-item"><h4>
          网课
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/geek.html" class="nav-link">
  专栏
</a></li><li class="dropdown-subitem"><a href="/book/video.html" class="nav-link">
  视频
</a></li></ul></li><li class="dropdown-item"><h4>
          面经
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/tech.html" class="nav-link">
  大厂面经
</a></li><li class="dropdown-subitem"><a href="/interview/sword-to-offer.html" class="nav-link">
  剑指Offer
</a></li><li class="dropdown-subitem"><a href="/interview/fe.html" class="nav-link">
  前端面经
</a></li><li class="dropdown-subitem"><a href="/interview/interview_guide.html" class="nav-link">
  面试导航
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/study.html" class="nav-link">
  学习笔记
</a></li></ul></li></ul></div></div> <a href="https://github.com/pengshuangbao/databook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link router-link-active">
  Java
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法 
</a></div><div class="nav-item"><a href="/architecture/" class="nav-link">
  架构 
</a></div><div class="nav-item"><a href="/computer/" class="nav-link">
  计算机 
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  数据库 
</a></div><div class="nav-item"><a href="/fe/" class="nav-link">
  前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维 " class="dropdown-title"><span class="title">运维 </span> <span class="arrow down"></span></button> <button type="button" aria-label="运维 " class="mobile-dropdown-title"><span class="title">运维 </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ops/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><h4>
          分类
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ops/java.html" class="nav-link">
  Java
</a></li><li class="dropdown-subitem"><a href="/ops/bigdata.html" class="nav-link">
  大数据
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><span class="title">编程</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程" class="mobile-dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/programming/python.html" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/programming/scala.html" class="nav-link">
  Scala
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源" class="dropdown-title"><span class="title">资源</span> <span class="arrow down"></span></button> <button type="button" aria-label="资源" class="mobile-dropdown-title"><span class="title">资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          我的书单
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/tech.html" class="nav-link">
  技术类
</a></li><li class="dropdown-subitem"><a href="/book/growth.html" class="nav-link">
  成长类
</a></li></ul></li><li class="dropdown-item"><h4>
          网课
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/geek.html" class="nav-link">
  专栏
</a></li><li class="dropdown-subitem"><a href="/book/video.html" class="nav-link">
  视频
</a></li></ul></li><li class="dropdown-item"><h4>
          面经
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/interview/tech.html" class="nav-link">
  大厂面经
</a></li><li class="dropdown-subitem"><a href="/interview/sword-to-offer.html" class="nav-link">
  剑指Offer
</a></li><li class="dropdown-subitem"><a href="/interview/fe.html" class="nav-link">
  前端面经
</a></li><li class="dropdown-subitem"><a href="/interview/interview_guide.html" class="nav-link">
  面试导航
</a></li></ul></li><li class="dropdown-item"><h4>
          其他
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/book/study.html" class="nav-link">
  学习笔记
</a></li></ul></li></ul></div></div> <a href="https://github.com/pengshuangbao/databook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/java/" aria-current="page" class="sidebar-link">Java</a></li><li><a href="/java/jvm.html" class="sidebar-link">JVM</a></li><li><a href="/java/coding.html" class="sidebar-link">编程</a></li><li><a href="/java/多线程.html" class="active sidebar-link">多线程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/多线程.html#并行和并发有什么区别" class="sidebar-link">并行和并发有什么区别?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#线程和进程的区别" class="sidebar-link">线程和进程的区别?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#说一下-runnable-和-callable-有什么区别" class="sidebar-link">说一下 runnable 和 callable 有什么区别?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#线程有哪些状态" class="sidebar-link">线程有哪些状态?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#sleep-和-wait-有什么区别" class="sidebar-link">sleep() 和 wait() 有什么区别?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#notify-和-notifyall-有什么区别" class="sidebar-link">notify()和 notifyAll()有什么区别?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#线程的-run-和-start-有什么区别" class="sidebar-link">线程的 run()和 start()有什么区别?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#创建线程池有哪几种方式" class="sidebar-link">创建线程池有哪几种方式?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#线程池都有哪些状态" class="sidebar-link">线程池都有哪些状态?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#线程池中-submit-和-execute-方法有什么区别" class="sidebar-link">线程池中 submit()和 execute()方法有什么区别?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#在-java-程序中怎么保证多线程的运行安全" class="sidebar-link">在 Java 程序中怎么保证多线程的运行安全?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#多线程锁的升级原理是什么" class="sidebar-link">多线程锁的升级原理是什么?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#什么是死锁-怎么防止死锁" class="sidebar-link">什么是死锁? 怎么防止死锁？</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#threadlocal-是什么-有哪些使用场景" class="sidebar-link">ThreadLocal 是什么?有哪些使用场景?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#说一下-synchronized-底层实现原理" class="sidebar-link">说一下 synchronized 底层实现原理?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#synchronized-和-volatile-的区别是什么" class="sidebar-link">synchronized 和 volatile 的区别是什么?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#volatile和synchronized的区别" class="sidebar-link">volatile和synchronized的区别</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#synchronized-和-reentrantlock-区别是什么" class="sidebar-link">synchronized 和 ReentrantLock 区别是什么?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#说一下-atomic-的原理" class="sidebar-link">说一下 atomic 的原理?</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#线程间如何通讯" class="sidebar-link">线程间如何通讯</a></li><li class="sidebar-sub-header"><a href="/java/多线程.html#偏向锁、自旋锁、轻量级锁、重量级锁" class="sidebar-link">偏向锁、自旋锁、轻量级锁、重量级锁</a></li></ul></li><li><a href="/java/java.html" class="sidebar-link">Java基础</a></li><li><a href="/java/java核心技术.html" class="sidebar-link">Java核心技术</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>jvm内存与垃圾回收</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>jvm字节码与类</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>jvm性能监控与调优</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="多线程"><a href="#多线程" class="header-anchor">#</a> 多线程</h1> <p></p><div class="table-of-contents"><ul><li><a href="#并行和并发有什么区别">并行和并发有什么区别?</a></li><li><a href="#线程和进程的区别">线程和进程的区别?</a><ul><li><a href="#线程间共享的资源">线程间共享的资源</a><ul><li><a href="#代码区域">代码区域</a></li><li><a href="#数据区">数据区</a></li><li><a href="#堆区">堆区</a></li><li><a href="#动态链接库">动态链接库</a></li><li><a href="#文件">文件</a></li></ul></li></ul></li><li><a href="#说一下-runnable-和-callable-有什么区别">说一下 runnable 和 callable 有什么区别?</a></li><li><a href="#线程有哪些状态">线程有哪些状态?</a></li><li><a href="#sleep-和-wait-有什么区别">sleep() 和 wait() 有什么区别?</a></li><li><a href="#notify-和-notifyall-有什么区别">notify()和 notifyAll()有什么区别?</a></li><li><a href="#线程的-run-和-start-有什么区别">线程的 run()和 start()有什么区别?</a></li><li><a href="#创建线程池有哪几种方式">创建线程池有哪几种方式?</a></li><li><a href="#线程池都有哪些状态">线程池都有哪些状态?</a></li><li><a href="#线程池中-submit-和-execute-方法有什么区别">线程池中 submit()和 execute()方法有什么区别?</a></li><li><a href="#在-java-程序中怎么保证多线程的运行安全">在 Java 程序中怎么保证多线程的运行安全?</a><ul><li><a href="#线程冲突的列子">线程冲突的列子</a></li></ul></li><li><a href="#多线程锁的升级原理是什么">多线程锁的升级原理是什么?</a></li><li><a href="#什么是死锁-怎么防止死锁">什么是死锁? 怎么防止死锁？</a></li><li><a href="#threadlocal-是什么-有哪些使用场景">ThreadLocal 是什么?有哪些使用场景?</a></li><li><a href="#说一下-synchronized-底层实现原理">说一下 synchronized 底层实现原理?</a></li><li><a href="#synchronized-和-volatile-的区别是什么">synchronized 和 volatile 的区别是什么?</a></li><li><a href="#volatile和synchronized的区别">volatile和synchronized的区别</a></li><li><a href="#synchronized-和-reentrantlock-区别是什么">synchronized 和 ReentrantLock 区别是什么?</a></li><li><a href="#说一下-atomic-的原理">说一下 atomic 的原理?</a></li><li><a href="#线程间如何通讯">线程间如何通讯</a></li><li><a href="#偏向锁、自旋锁、轻量级锁、重量级锁">偏向锁、自旋锁、轻量级锁、重量级锁</a><ul><li><a href="#重量级锁">重量级锁</a></li><li><a href="#自旋锁">自旋锁</a></li><li><a href="#自适应自旋锁">自适应自旋锁</a></li><li><a href="#轻量级锁">轻量级锁</a></li><li><a href="#偏向锁">偏向锁</a></li></ul></li></ul></div><p></p> <h2 id="并行和并发有什么区别"><a href="#并行和并发有什么区别" class="header-anchor">#</a> 并行和并发有什么区别?</h2> <p><a href="https://databook.lovedata.net/java/jvm%E5%86%85%E5%AD%98%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/16%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5.html#%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B9%B6%E8%A1%8C%E4%B8%8E%E5%B9%B6%E5%8F%91" target="_blank" rel="noopener noreferrer">第十六章、垃圾回收相关概念 | 编程手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="线程和进程的区别"><a href="#线程和进程的区别" class="header-anchor">#</a> 线程和进程的区别?</h2> <p>参考:</p> <p><a href="https://blog.csdn.net/csdnnews/article/details/111878136" target="_blank" rel="noopener noreferrer">线程与进程，你真的清楚吗？_CSDN资讯-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>进程是操作系统分配资源的单位，线程是调度的基本单位，线程之间共享进程资源</strong></p> <blockquote><p>线程就是函数的调用流程，每个线程由自己的栈帧</p></blockquote> <p><img src="https://static.lovedata.net/21-02-02-e478161a8dc4d03daa44ddb92e689a99.png" alt="image"></p> <blockquote><p>每个线程都有自己独立的、私有的栈区。</p> <p><strong>所属线程的栈区、程序计数器、栈指针以及函数运行使用的寄存器是线程私有的。</strong></p></blockquote> <p><img src="https://static.lovedata.net/21-02-02-44a51153154cd0ae0b05f851075f1c74.png" alt="image"></p> <h3 id="线程间共享的资源"><a href="#线程间共享的资源" class="header-anchor">#</a> 线程间共享的资源</h3> <p><img src="https://static.lovedata.net/21-02-02-205a367795a9655b7c115f5f69cf7ef3.png" alt="image"></p> <h4 id="代码区域"><a href="#代码区域" class="header-anchor">#</a> 代码区域</h4> <p><img src="https://static.lovedata.net/21-02-02-b372e2a5b635f3a92eb0ddb46c7dab6a.png" alt="image"></p> <h4 id="数据区"><a href="#数据区" class="header-anchor">#</a> 数据区</h4> <blockquote><p>C语言中的全局变量</p></blockquote> <p>​	<img src="https://static.lovedata.net/21-02-02-ea45c425404b50d297dc4460d9f4a09f.png" alt="image"></p> <h4 id="堆区"><a href="#堆区" class="header-anchor">#</a> 堆区</h4> <blockquote><p>new出来的对象</p></blockquote> <p><img src="https://static.lovedata.net/21-02-02-625d3d398f1558e9ff18e10a4b8cbd7e.png" alt="image"></p> <h4 id="动态链接库"><a href="#动态链接库" class="header-anchor">#</a> 动态链接库</h4> <blockquote><p>源码生成可执行文件，</p> <p>静态链接：一股脑生成一个exe文件</p> <p>动态链接：动态链接的意思是我们<strong>不把动态链接的部分打包到可执行程序，而是在可执行程序运行起来后去内存中找动态链接的那部分代码，</strong></p></blockquote> <p><img src="https://static.lovedata.net/21-02-02-b7eb50230326891e810ab93bd486d91d.png" alt="image"></p> <p><img src="https://static.lovedata.net/21-02-02-a59bf17e7c04c26a308aa26f9ec767ee.png" alt="image"></p> <h4 id="文件"><a href="#文件" class="header-anchor">#</a> 文件</h4> <p><img src="https://static.lovedata.net/21-02-02-2d6b75aad2608425687e18012598112b.png" alt="image"></p> <h2 id="说一下-runnable-和-callable-有什么区别"><a href="#说一下-runnable-和-callable-有什么区别" class="header-anchor">#</a> 说一下 runnable 和 callable 有什么区别?</h2> <p>Runnable和Callable的区别是bai，
(1)Callable规定的方法是call(),Runnable规定的方法是run().
(2)Callable的任务执行后可返回值，而Runnable的任务是不能返回值得
(3)call方法可以抛出异常，run方法不可以
(4)运行Callable任务可以拿到一个Future对象，表示异步计算的结果。它提供了检查计算是否完成的方法，以等待计算的完成，并检索计算的结果。通过Future对象可以了解任务执行情况，可取消任务的执行，还可获取执行结果。</p> <h2 id="线程有哪些状态"><a href="#线程有哪些状态" class="header-anchor">#</a> 线程有哪些状态?</h2> <p><a href="https://blog.csdn.net/xingjing1226/article/details/81977129" target="_blank" rel="noopener noreferrer">线程的5种状态详解_老猫的博客-CSDN博客_线程的几种状态<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://static.lovedata.net/21-02-02-36d8d721e022e790c12d8729f3243733.png" alt="image"></p> <h2 id="sleep-和-wait-有什么区别"><a href="#sleep-和-wait-有什么区别" class="header-anchor">#</a> sleep() 和 wait() 有什么区别?</h2> <p><a href="https://www.cnblogs.com/116970u/p/11506663.html" target="_blank" rel="noopener noreferrer">sleep() 和 wait() 有什么区别？ - 清晨的第一抹阳光 - 博客园<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>sleep()和wait()都是线程暂停执行的方法。</p> <p>1、这两个方法来自不同的类分别是Thread和Object，sleep方法属于Thread类中的静态方法，wait属于Object的成员方法。
2、<strong>sleep()<strong>是线程类（Thread）的方法，不涉及线程通信，调用时会暂停此线程指定的时间，但监控依然保持，<strong>不会释放对象锁</strong>，到时间</strong>自动恢复</strong>；<strong>wait()<strong>是Object的方法，用于线程间的通信，调用时会</strong>放弃对象锁</strong>，进入<strong>等待</strong>队列，待调用notify()/notifyAll()唤醒指定的线程或者所有线程，才进入对象锁定池准备获得对象锁进入运行状态。
3、wait，notify和notifyAll只能在<strong>同步控制方法</strong>或者<strong>同步控制块</strong>里面使用，而sleep可以在任何地方使用（使用范围）。
4、sleep()方法必须捕获异常InterruptedException，而wait()\notify()以及notifyAll()不需要捕获异常。</p> <p><strong>注意：</strong></p> <p>sleep方法只让出了CPU，而并不会释放同步资源锁。</p> <p>线程执行sleep()方法后会转入阻塞状态。</p> <p>sleep()方法指定的时间为线程不会运行的最短时间。因此，sleep()方法不能保证该线程睡眠到期后就开始执行。</p> <p>notify的作用相当于叫醒睡着的人，而并不会给他分配任务，就是说notify只是让之前调用wait的线程有权利重新参与线程的调度。</p> <h2 id="notify-和-notifyall-有什么区别"><a href="#notify-和-notifyall-有什么区别" class="header-anchor">#</a> notify()和 notifyAll()有什么区别?</h2> <p>notify()和notifyAll()都是baiObject对象用于通du知处在等待该对象的线zhi程dao的方法。zhuan
void notify(): 唤醒一个正在shu等待该对象的线程。
void notifyAll(): 唤醒所有正在等待该对象的线程。
两者的最大区别在于：
notifyAll使所有原来在该对象上等待被notify的线程统统退出wait的状态，变成等待该对象上的锁，一旦该对象被解锁，他们就会去竞争。
notify他只是选择一个wait状态线程进行通知，并使它获得该对象上的锁，但不惊动其他同样在等待被该对象notify的线程们，当第一个线程运行完毕以后释放对象上的锁，此时如果该对象没有再次使用notify语句，即便该对象已经空闲，其他wait状态等待的线程由于没有得到该对象的通知，继续处在wait状态，直到这个对象发出一个notify
notifyAll，它们等待的是被notify或notifyAll，而不是锁。</p> <h2 id="线程的-run-和-start-有什么区别"><a href="#线程的-run-和-start-有什么区别" class="header-anchor">#</a> 线程的 run()和 start()有什么区别?</h2> <ul><li>调用 start() 方法是用来启动线程的，轮到该线程执行时，会自动调用 run()；直接调用 run() 方法，无法达到启动多线程的目的，相当于主线程线性执行 Thread 对象的 run() 方法。</li> <li>一个线程对线的 start() 方法只能调用一次，多次调用会抛出 java.lang.IllegalThreadStateException 异常；run() 方法没有限制。</li></ul> <h2 id="创建线程池有哪几种方式"><a href="#创建线程池有哪几种方式" class="header-anchor">#</a> 创建线程池有哪几种方式?</h2> <p><a href="https://blog.csdn.net/lyong1223/article/details/105924558" target="_blank" rel="noopener noreferrer">创建线程池有哪几种方式_XiaoY的专栏-CSDN博客_线程池的创建方式有几种<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <table><thead><tr><th>index</th> <th>method</th> <th>corePoolSize</th> <th>maximumPoolSize</th> <th>keepAliveTime</th> <th>unit</th> <th>workQueue</th></tr></thead> <tbody><tr><td>1</td> <td>newCachedThreadPool</td> <td>0</td> <td>Integer.MAX_VALUE</td> <td>60L</td> <td>TimeUnit.SECONDS</td> <td>SynchronousQueue</td></tr> <tr><td>2</td> <td>newFixedThreadPool</td> <td>自定义</td> <td>与corePoolSize相同</td> <td>0L</td> <td>TimeUnit.MILLISECONDS</td> <td>LinkedBlockingQueue</td></tr> <tr><td>3</td> <td>newSingleThreadExecutor</td> <td>1</td> <td>1</td> <td>0L</td> <td>TimeUnit.MILLISECONDS</td> <td>LinkedBlockingQueue</td></tr> <tr><td>4</td> <td>newScheduledThreadPool</td> <td>自定义</td> <td>Integer.MAX_VALUE</td> <td>0</td> <td>NANOSECONDS</td> <td>DelayedWorkQueue</td></tr> <tr><td>5</td> <td>newSingleThreadScheduledExecutor</td> <td>1</td> <td>Integer.MAX_VALUE</td> <td>0</td> <td>NANOSECONDS</td> <td>DelayedWorkQueue</td></tr></tbody></table> <h2 id="线程池都有哪些状态"><a href="#线程池都有哪些状态" class="header-anchor">#</a> 线程池都有哪些状态?</h2> <p><strong>1.RUNNING</strong>：这是最正常的状态，接受新的任务，处理等待队列中的任务。线程池的初始化状态是RUNNING。线程池被一旦被创建，就处于RUNNING状态，并且线程池中的任务数为0。</p> <p><strong>2.SHUTDOWN</strong>：不接受新的任务提交，但是会继续处理等待队列中的任务。调用线程池的shutdown()方法时，线程池由RUNNING -&gt; SHUTDOWN。</p> <p><strong>3.STOP</strong>：不接受新的任务提交，不再处理等待队列中的任务，中断正在执行任务的线程。调用线程池的shutdownNow()方法时，线程池由(RUNNING or SHUTDOWN ) -&gt; STOP。</p> <p><strong>4.TIDYING</strong>：所有的任务都销毁了，workCount 为 0，线程池的状态在转换为 TIDYING 状态时，会执行钩子方法 terminated()。因为terminated()在ThreadPoolExecutor类中是空的，所以用户想在线程池变为TIDYING时进行相应的处理；可以通过重载terminated()函数来实现。</p> <p>当线程池在SHUTDOWN状态下，阻塞队列为空并且线程池中执行的任务也为空时，就会由 SHUTDOWN -&gt; TIDYING。</p> <p>当线程池在STOP状态下，线程池中执行的任务为空时，就会由STOP -&gt; TIDYING。</p> <p><strong>5.TERMINATED</strong>：线程池处在TIDYING状态时，执行完terminated()之后，就会由 TIDYING -&gt; TERMINATED。</p> <h2 id="线程池中-submit-和-execute-方法有什么区别"><a href="#线程池中-submit-和-execute-方法有什么区别" class="header-anchor">#</a> 线程池中 submit()和 execute()方法有什么区别?</h2> <ul><li>execute() 参数 Runnable ；submit() 参数 (Runnable) 或 (Runnable 和 结果 T) 或 (Callable)</li> <li>execute() 没有返回值；而 submit() 有返回值</li> <li>submit() 的返回值 Future 调用get方法时，可以捕获处理异常</li></ul> <h2 id="在-java-程序中怎么保证多线程的运行安全"><a href="#在-java-程序中怎么保证多线程的运行安全" class="header-anchor">#</a> 在 Java 程序中怎么保证多线程的运行安全?</h2> <p>线程的安全性问题体现在：</p> <ul><li>原子性：一个或者多个操作在 CPU 执行的过程中不被中断的特性</li> <li>可见性：一个线程对共享变量的修改，另外一个线程能够立刻看到</li> <li>有序性：程序执行的顺序按照代码的先后顺序执行</li></ul> <p>导致原因：</p> <ul><li>缓存导致的可见性问题</li> <li>线程切换带来的原子性问题</li> <li>编译优化带来的有序性问题</li></ul> <p>解决办法：</p> <ul><li>JDK Atomic开头的原子类、synchronized、LOCK，可以解决原子性问题</li> <li>synchronized、volatile、LOCK，可以解决可见性问题</li> <li>Happens-Before 规则可以解决有序性问题</li></ul> <p><a href="https://juejin.cn/post/6844903890224152584" target="_blank" rel="noopener noreferrer">图解 Java 线程安全<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://static.lovedata.net/21-02-03-cffcc5e0f046c4487077d193ed0588d9.png" alt="image"></p> <p><img src="https://static.lovedata.net/21-02-03-bd70e7c30af43069fc04efbcac428cb5.png" alt="image"></p> <h3 id="线程冲突的列子"><a href="#线程冲突的列子" class="header-anchor">#</a> 线程冲突的列子</h3> <p><img src="https://static.lovedata.net/21-02-03-92121a2b35d1d75dfda90c8b3e42e3c7.png" alt="image"></p> <h2 id="多线程锁的升级原理是什么"><a href="#多线程锁的升级原理是什么" class="header-anchor">#</a> 多线程锁的升级原理是什么?</h2> <h2 id="什么是死锁-怎么防止死锁"><a href="#什么是死锁-怎么防止死锁" class="header-anchor">#</a> 什么是死锁? 怎么防止死锁？</h2> <p><a href="https://databook.lovedata.net/java/java.html#%E7%AC%AC18%E8%AE%B2-%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8Bjava%E7%A8%8B%E5%BA%8F%E4%BC%9A%E4%BA%A7%E7%94%9F%E6%AD%BB%E9%94%81-%E5%A6%82%E4%BD%95%E5%AE%9A%E4%BD%8D%E3%80%81%E4%BF%AE%E5%A4%8D" target="_blank" rel="noopener noreferrer">Java基础 什么事思索？怎么防止死锁 | 编程手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="threadlocal-是什么-有哪些使用场景"><a href="#threadlocal-是什么-有哪些使用场景" class="header-anchor">#</a> ThreadLocal 是什么?有哪些使用场景?</h2> <p>Java 提供的一种<strong>保存线程私有信息</strong>的机制，因为其在整个<strong>线程生命周期内有效</strong>，所以可以方便地在一个线程关联的不同业务模块之间<strong>传递信息</strong>，比如事务 ID、Cookie 等上下文相关信息。</p> <p>废弃项目的回收依赖于显式地触发，否则就要等待线程结束，进而回收相应 ThreadLocalMap！这就是很多 <strong>OOM 的来源</strong>，所以通常都会建议，应用一定要自己负责 remove，并且不要和线程池配合，因为 worker 线程往往是不会退出的。</p> <h2 id="说一下-synchronized-底层实现原理"><a href="#说一下-synchronized-底层实现原理" class="header-anchor">#</a> 说一下 synchronized 底层实现原理?</h2> <p><a href="https://databook.lovedata.net/java/java.html#%E7%AC%AC16%E8%AE%B2-synchronized%E5%BA%95%E5%B1%82%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0-%E4%BB%80%E4%B9%88%E6%98%AF%E9%94%81%E7%9A%84%E5%8D%87%E7%BA%A7%E3%80%81%E9%99%8D%E7%BA%A7" target="_blank" rel="noopener noreferrer">Java基础-synchronized底层实现原理 | 编程手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="synchronized-和-volatile-的区别是什么"><a href="#synchronized-和-volatile-的区别是什么" class="header-anchor">#</a> synchronized 和 volatile 的区别是什么?</h2> <p><a href="https://mp.weixin.qq.com/s/lmaWjqCkbBU92zt2V2cxOg" target="_blank" rel="noopener noreferrer">synchronized详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/suifeng3051/article/details/52611233" target="_blank" rel="noopener noreferrer">volatile和synchronized的区别_Heaven Wang 的专栏-CSDN博客_synchronized和volatile区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="volatile和synchronized的区别"><a href="#volatile和synchronized的区别" class="header-anchor">#</a> volatile和synchronized的区别</h2> <ol><li>volatile本质是在告诉jvm当前变量在寄存器（工作内存）中的值是<strong>不确定</strong>的，需要从<strong>主存中</strong>读取； <strong>synchronized</strong>则是锁定当前变量，只有当前线程可以访问该变量，其他线程被阻塞住。</li> <li>volatile仅能使用在<strong>变量级别</strong>；synchronized则可以使用在<strong>变量、方法、和类级别</strong>的</li> <li>volatile仅能实现变量的修改可见性，不能保证<strong>原子性</strong>；而synchronized则可以保证<strong>变量的修改可见性和原子性</strong></li> <li>volatile不会造成线程的阻塞；synchronized可能会造成线程的<strong>阻塞</strong>。</li> <li>volatile标记的变量不会被编译器优化；synchronized标记的变量可以被编译器优化</li></ol> <p><a href="https://juejin.cn/post/6844903925783642125" target="_blank" rel="noopener noreferrer">4个点说清楚Java中synchronized和volatile的区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>1、Java语言为了解决并发编程中存在的原子性、可见性和有序性问题，提供了一系列和并发处理相关的关键字，比如synchronized、volatile、final、concurren包等。</p> <p>2、synchronized通过加锁的方式，使得其在需要原子性、可见性和有序性这三种特性的时候都可以作为其中一种解决方案，看起来是“万能”的。的确，大部分并发控制操作都能使用synchronized来完成。</p> <p>3、volatile通过在volatile变量的操作前后插入内存屏障的方式，保证了变量在并发场景下的可见性和有序性。</p> <p>4、volatile关键字是无法保证原子性的，而synchronized通过monitorenter和monitorexit两个指令，可以保证被synchronized修饰的代码在同一时间只能被一个线程访问，即可保证不会出现CPU时间片在多个线程间切换，即可保证原子性。</p> <p><img src="https://static.lovedata.net/21-02-03-58259f1e7098252a099849c882ca7fd1.png" alt="image"></p> <h2 id="synchronized-和-reentrantlock-区别是什么"><a href="#synchronized-和-reentrantlock-区别是什么" class="header-anchor">#</a> synchronized 和 ReentrantLock 区别是什么?</h2> <ul><li>synchronized 竞争锁时会一直等待；ReentrantLock 可以尝试获取锁，并得到获取结果</li> <li>synchronized 获取锁无法设置超时；ReentrantLock 可以设置获取锁的超时时间</li> <li>synchronized 无法实现公平锁；ReentrantLock 可以满足公平锁，即先等待先获取到锁</li> <li>synchronized 控制等待和唤醒需要结合加锁对象的 wait() 和 notify()、notifyAll()；ReentrantLock 控制等待和唤醒需要结合 Condition 的 await() 和 signal()、signalAll() 方法</li> <li>synchronized 是 JVM 层面实现的；ReentrantLock 是 JDK 代码层面实现</li> <li>synchronized 在加锁代码块执行完或者出现异常，自动释放锁；ReentrantLock 不会自动释放锁，需要在 finally{} 代码块显示释放</li></ul> <h2 id="说一下-atomic-的原理"><a href="#说一下-atomic-的原理" class="header-anchor">#</a> 说一下 atomic 的原理?</h2> <p>JDK Atomic开头的类，是通过 CAS 原理解决并发情况下原子性问题。</p> <p>CAS 包含 3 个参数，CAS(V, E, N)。V 表示需要更新的变量，E 表示变量当前期望值，N 表示更新为的值。只有当变量 V 的值等于 E 时，变量 V 的值才会被更新为 N。如果变量 V 的值不等于 E ，说明变量 V 的值已经被更新过，当前线程什么也不做，返回更新失败。</p> <p>当多个线程同时使用 CAS 更新一个变量时，只有一个线程可以更新成功，其他都失败。失败的线程不会被挂起，可以继续重试 CAS，也可以放弃操作。</p> <p>CAS 操作的原子性是通过 CPU 单条指令完成而保障的。JDK 中是通过 Unsafe 类中的 API 完成的。</p> <p>在并发量很高的情况，会有大量 CAS 更新失败，所以需要慎用。</p> <h2 id="线程间如何通讯"><a href="#线程间如何通讯" class="header-anchor">#</a> 线程间如何通讯</h2> <p>CountDownLatch 利用它可以实现类似计数器的功能。比如有一个任务A，它要等待其他4个任务执行完毕之后才能执行，此时就可以利用CountDownLatch来实现这种功能了。</p> <p>CyclicBarrier 字面意思回环栅栏，通过它可以实现让<strong>一组线程等待至某个状态之后</strong>再全部同时执行。叫做回环是因为当所有等待线程都被释放以后，<strong>CyclicBarrier可以被重用</strong>。我们暂且把这个状态就叫做barrier，当调用await()方法之后，线程就处于barrier了
1）CountDownLatch和CyclicBarrier都能够实现线程之间的等待，只不过它们侧重点不同：</p> <p>CountDownLatch一般用于某个线程A等待若干个其他线程执行完任务之后，它才执行；</p> <p>而CyclicBarrier一般用于一组线程互相等待至某个状态，然后这一组线程再同时执行；</p> <p>另外，CountDownLatch是不能够重用的，而CyclicBarrier是可以重用的。</p> <p>2）Semaphore其实和锁有点类似，它一般用于控制对某组资源的访问权限。</p> <p><a href="https://www.cnblogs.com/dolphin0520/p/3920397.html" target="_blank" rel="noopener noreferrer">Java并发编程：CountDownLatch、CyclicBarrier和Semaphore<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://www.importnew.com/26850.html" target="_blank" rel="noopener noreferrer">Java 里如何实现线程间通信<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/u011514810/article/details/77131296" target="_blank" rel="noopener noreferrer">java线程间通信<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="偏向锁、自旋锁、轻量级锁、重量级锁"><a href="#偏向锁、自旋锁、轻量级锁、重量级锁" class="header-anchor">#</a> 偏向锁、自旋锁、轻量级锁、重量级锁</h2> <h3 id="重量级锁"><a href="#重量级锁" class="header-anchor">#</a> 重量级锁</h3> <p>内置锁在Java中被抽象为监视器锁（monitor）。在JDK 1.6之前，监视器锁可以认为直接对应底层操作系统中的互斥量（mutex）。这种同步方式的成本非常高，包括系统调用引起的内核态与用户态切换、线程阻塞造成的线程切换等。因此，后来称这种锁为“重量级锁”。</p> <h3 id="自旋锁"><a href="#自旋锁" class="header-anchor">#</a> 自旋锁</h3> <p>内核态与用户态切换仪容仪表优化，通过自旋锁，减少线程阻塞造成的线程切换</p> <p>锁粒度小，持有时间短，锁阻塞造成线程切换时间持有时间相当，减少线程切换</p> <p>缺点</p> <ul><li>单核不存在并行，当前不阻塞自己的话，就的不能执行，锁永远不会释放，自旋无用</li> <li>自旋占用CPU，</li> <li>锁竞争时间长，自旋无法获得，浪费时间</li></ul> <h3 id="自适应自旋锁"><a href="#自适应自旋锁" class="header-anchor">#</a> 自适应自旋锁</h3> <p>自适应意味着自旋的时间不再固定了，而是由前一次在同一个锁上的自旋时间及锁的拥有者的状态来决定</p> <p>然而，自适应自旋也没能彻底解决该问题，</p> <h3 id="轻量级锁"><a href="#轻量级锁" class="header-anchor">#</a> 轻量级锁</h3> <h3 id="偏向锁"><a href="#偏向锁" class="header-anchor">#</a> 偏向锁</h3> <p>偏向锁、轻量级锁、重量级锁适用于不同的并发场景：</p> <ul><li>偏向锁：无实际竞争，且将来只有第一个申请锁的线程会使用锁。</li> <li>轻量级锁：无实际竞争，多个线程交替使用锁；允许短时间的锁竞争。</li> <li>重量级锁：有实际竞争，且锁竞争时间长。</li></ul> <p>如果锁竞争时间短，可以使用<strong>自旋锁</strong>进一步优化轻量级锁、重量级锁的性能，<strong>减少线程切换</strong>。</p> <p><img src="https://static.lovedata.net/20-05-20-a2a3b758b480c8f7018b76acf39d5bc9.png" alt="image"></p> <p><a href="https://mp.weixin.qq.com/s/lmaWjqCkbBU92zt2V2cxOg" target="_blank" rel="noopener noreferrer">synchronized详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.im/post/5a5c09d051882573282164ae" target="_blank" rel="noopener noreferrer">浅谈偏向锁、轻量级锁、重量级锁 - 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.dreamtobe.cn/2015/11/13/java_synchronized/" target="_blank" rel="noopener noreferrer">Java Synchronised机制 | Jacks Blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/lkforce/article/details/81128115" target="_blank" rel="noopener noreferrer">Java的对象头和对象组成详解_java_lkforce-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/pengshuangbao/databook/edit/master/docs/java/多线程.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2023/4/14 16:56:47</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java/coding.html" class="prev">
        编程
      </a></span> <span class="next"><a href="/java/java.html">
        Java基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.0f56a723.js" defer></script><script src="/assets/js/4.a8ef5668.js" defer></script><script src="/assets/js/177.ba85b912.js" defer></script><script src="/assets/js/11.0473ae06.js" defer></script>
  </body>
</html>
